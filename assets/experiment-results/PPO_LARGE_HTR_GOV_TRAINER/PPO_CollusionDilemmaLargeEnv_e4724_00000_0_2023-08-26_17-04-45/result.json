{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.017012231444479, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5578812212713302, "policy_loss": -0.008602634328667836, "vf_loss": 1.5642544944279937, "vf_explained_var": -0.002448644689334336, "kl": 0.011146754714186548, "entropy": 0.6819500894315781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 452.01380234336875, "episode_reward_min": 19.586562237739567, "episode_reward_mean": 30.352417841252414, "episode_len_mean": 18.181818181818183, "episode_media": {}, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.0801184673311, 23.123124594688417, 24.73356202316284, 23.351562213897704, 25.23412447547913, 24.61856219005585, 25.337999594688416, 22.90756223773956, 24.020562047004702, 24.484999594688414, 24.85799961853027, 24.475124570846557, 24.089562094688418, 25.33099942779541, 25.837561999320982, 24.48999964237213, 25.485562094688415, 24.33212449932099, 24.84812461853027, 25.326562094688413, 23.44699976158142, 27.005561880111692, 21.799562190055845, 24.60256207084656, 25.688124380111695, 27.126124594688413, 27.291124594688416, 24.620999570846557, 24.721999642372136, 25.156561975479125, 22.393562261581422, 25.75799952316284, 21.031687285423278, 27.69699945163727, 25.65799959468842, 22.738562309265138, 23.83356223773956, 25.925561999320983, 25.358686856269834, 21.82256230926513, 23.3741245470047, 25.47312469005585, 24.703999523162842, 25.044561975479123, 25.21299964237213, 24.84799957084656, 22.523999713897705, 24.53412435626983, 26.503561903953557, 23.678562190055843, 25.562562094688417, 24.77356195163727, 25.59599957084656, 21.456999809265135, 24.880561808586123, 21.093124737739565, 23.21356209468842, 28.330561975479124, 25.248999618530274, 20.053562356948852, 24.92468695163727, 24.598561951637265, 26.82612457084656, 26.2609995470047, 21.77512469005585, 27.463687047004697, 22.45099959468841, 26.097999356269835, 24.82456202316284, 26.65256216621399, 26.569561832427976, 25.09356199932098, 24.298562094688418, 26.558999594688416, 25.656999332427976, 24.48656214237213, 24.232562094688415, 26.602562070846556, 25.299999594688412, 26.221999594688416, 25.57212452316284, 21.39156214237213, 24.717562070846554, 22.661999690055847, 24.587124570846562, 23.973562118530275, 24.013999618530278, 23.157562094688416, 22.93299961853027, 23.525124523162845, 22.10312466621399, 24.96156199932098, 26.34012459468842, 25.362124523162844, 22.076562237739562, 24.460562142372126, 26.826562142372133, 24.614561999320983, 19.586562237739567, 25.43012452316284, 26.022999451637272, 25.88599949932098, 22.284124761581417, 24.38156197547913, 23.213562142372126, 22.82356219005585, 24.82499961853027, 23.73356230926514, 23.74199969005585, 25.862999523162838, 452.01380234336875, 27.76299933242798, 31.045561713218692, 29.6109992609024, 29.19912421321869, 26.232999499320982, 27.296562023162842, 29.373999284744265, 30.17056185626984, 31.091999141693115, 32.11912411785126, 29.055999213218684, 29.355561617851258, 26.36599952316284, 27.49799942779541, 28.34756185626984, 26.563124380111695, 29.74812414169312, 29.61999933242798, 28.59756183242798, 28.571124403953554, 27.954999475479127, 27.74399921321869, 28.913999237060548, 30.127999260902403, 27.49512447547912, 28.128999260902408, 30.235561737060547, 30.69912421321869, 30.207561713218695, 27.338561856269834, 30.18656171321869, 27.14656197547913, 28.830561641693116, 28.0569992609024, 31.470999189376826, 30.54099921321869, 30.960124189376835, 29.412561951637265, 30.49256190395355, 27.19699942779541, 26.043124475479125, 28.070561880111693, 30.858561689376828, 30.443999356269835, 28.84099914169312, 29.578561665534966, 29.628561975479126, 31.086999308586122, 28.281561903953552, 31.353999141693116, 27.157561856269833, 28.752124094009403, 29.55899935626984, 27.75112433242798, 28.09056185626984, 29.104561999320982, 28.662999213218686, 27.483561951637267, 29.414561951637264, 28.550999332427978, 30.74056171321869, 28.52312438011169, 30.45212416553497, 29.011999332427976, 26.382124523162847, 28.790561903953556, 29.025561641693113, 28.009686856269834, 28.574561903953555, 31.109999141693116, 28.06099935626984, 27.673562023162845, 29.946561999320984, 28.401124356269833, 27.06812435626984, 29.327999403953548, 28.211124237060552, 27.50399916553497, 25.958124618530274, 25.049561808586123, 29.364124523162843, 29.607561784744256, 27.696561903953555, 30.103124189376828, 27.614124380111697, 29.691561784744266, 29.784562047004698, 31.688124022483827, 29.00112428474426, 27.947124356269835, 29.210124284744264, 27.491124213218686, 28.825561641693113, 27.754561951637267, 29.96699930858612, 28.79256166553497, 29.43756178474426, 30.682999237060546, 30.49856171321869, 27.152561999320984, 29.587561737060543, 27.551999260902402, 29.190124237060544, 29.979999189376834, 32.03256164169312, 31.517561617851253, 27.67256176090241, 28.129561975479124, 31.52556161785126], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0303028936924665, "mean_inference_ms": 0.8851067534927605, "mean_action_processing_ms": 0.10230635357522655, "mean_env_wait_ms": 0.059388328468364705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027130842208862305, "StateBufferConnector_ms": 0.03572691570628773, "ViewRequirementAgentConnector_ms": 0.24201674894853073}}, "episode_reward_max": 452.01380234336875, "episode_reward_min": 19.586562237739567, "episode_reward_mean": 30.352417841252414, "episode_len_mean": 18.181818181818183, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [394.0801184673311, 23.123124594688417, 24.73356202316284, 23.351562213897704, 25.23412447547913, 24.61856219005585, 25.337999594688416, 22.90756223773956, 24.020562047004702, 24.484999594688414, 24.85799961853027, 24.475124570846557, 24.089562094688418, 25.33099942779541, 25.837561999320982, 24.48999964237213, 25.485562094688415, 24.33212449932099, 24.84812461853027, 25.326562094688413, 23.44699976158142, 27.005561880111692, 21.799562190055845, 24.60256207084656, 25.688124380111695, 27.126124594688413, 27.291124594688416, 24.620999570846557, 24.721999642372136, 25.156561975479125, 22.393562261581422, 25.75799952316284, 21.031687285423278, 27.69699945163727, 25.65799959468842, 22.738562309265138, 23.83356223773956, 25.925561999320983, 25.358686856269834, 21.82256230926513, 23.3741245470047, 25.47312469005585, 24.703999523162842, 25.044561975479123, 25.21299964237213, 24.84799957084656, 22.523999713897705, 24.53412435626983, 26.503561903953557, 23.678562190055843, 25.562562094688417, 24.77356195163727, 25.59599957084656, 21.456999809265135, 24.880561808586123, 21.093124737739565, 23.21356209468842, 28.330561975479124, 25.248999618530274, 20.053562356948852, 24.92468695163727, 24.598561951637265, 26.82612457084656, 26.2609995470047, 21.77512469005585, 27.463687047004697, 22.45099959468841, 26.097999356269835, 24.82456202316284, 26.65256216621399, 26.569561832427976, 25.09356199932098, 24.298562094688418, 26.558999594688416, 25.656999332427976, 24.48656214237213, 24.232562094688415, 26.602562070846556, 25.299999594688412, 26.221999594688416, 25.57212452316284, 21.39156214237213, 24.717562070846554, 22.661999690055847, 24.587124570846562, 23.973562118530275, 24.013999618530278, 23.157562094688416, 22.93299961853027, 23.525124523162845, 22.10312466621399, 24.96156199932098, 26.34012459468842, 25.362124523162844, 22.076562237739562, 24.460562142372126, 26.826562142372133, 24.614561999320983, 19.586562237739567, 25.43012452316284, 26.022999451637272, 25.88599949932098, 22.284124761581417, 24.38156197547913, 23.213562142372126, 22.82356219005585, 24.82499961853027, 23.73356230926514, 23.74199969005585, 25.862999523162838, 452.01380234336875, 27.76299933242798, 31.045561713218692, 29.6109992609024, 29.19912421321869, 26.232999499320982, 27.296562023162842, 29.373999284744265, 30.17056185626984, 31.091999141693115, 32.11912411785126, 29.055999213218684, 29.355561617851258, 26.36599952316284, 27.49799942779541, 28.34756185626984, 26.563124380111695, 29.74812414169312, 29.61999933242798, 28.59756183242798, 28.571124403953554, 27.954999475479127, 27.74399921321869, 28.913999237060548, 30.127999260902403, 27.49512447547912, 28.128999260902408, 30.235561737060547, 30.69912421321869, 30.207561713218695, 27.338561856269834, 30.18656171321869, 27.14656197547913, 28.830561641693116, 28.0569992609024, 31.470999189376826, 30.54099921321869, 30.960124189376835, 29.412561951637265, 30.49256190395355, 27.19699942779541, 26.043124475479125, 28.070561880111693, 30.858561689376828, 30.443999356269835, 28.84099914169312, 29.578561665534966, 29.628561975479126, 31.086999308586122, 28.281561903953552, 31.353999141693116, 27.157561856269833, 28.752124094009403, 29.55899935626984, 27.75112433242798, 28.09056185626984, 29.104561999320982, 28.662999213218686, 27.483561951637267, 29.414561951637264, 28.550999332427978, 30.74056171321869, 28.52312438011169, 30.45212416553497, 29.011999332427976, 26.382124523162847, 28.790561903953556, 29.025561641693113, 28.009686856269834, 28.574561903953555, 31.109999141693116, 28.06099935626984, 27.673562023162845, 29.946561999320984, 28.401124356269833, 27.06812435626984, 29.327999403953548, 28.211124237060552, 27.50399916553497, 25.958124618530274, 25.049561808586123, 29.364124523162843, 29.607561784744256, 27.696561903953555, 30.103124189376828, 27.614124380111697, 29.691561784744266, 29.784562047004698, 31.688124022483827, 29.00112428474426, 27.947124356269835, 29.210124284744264, 27.491124213218686, 28.825561641693113, 27.754561951637267, 29.96699930858612, 28.79256166553497, 29.43756178474426, 30.682999237060546, 30.49856171321869, 27.152561999320984, 29.587561737060543, 27.551999260902402, 29.190124237060544, 29.979999189376834, 32.03256164169312, 31.517561617851253, 27.67256176090241, 28.129561975479124, 31.52556161785126], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0303028936924665, "mean_inference_ms": 0.8851067534927605, "mean_action_processing_ms": 0.10230635357522655, "mean_env_wait_ms": 0.059388328468364705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027130842208862305, "StateBufferConnector_ms": 0.03572691570628773, "ViewRequirementAgentConnector_ms": 0.24201674894853073}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.05648438926045, "num_env_steps_trained_throughput_per_sec": 412.05648438926045, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9707.358, "sample_time_ms": 4215.203, "load_time_ms": 0.453, "load_throughput": 8834763.56, "learn_time_ms": 5488.945, "learn_throughput": 728.737, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 220, "training_iteration": 1, "trial_id": "e4724_00000", "date": "2023-08-26_17-04-59", "timestamp": 1693062299, "time_this_iter_s": 9.71904706954956, "time_total_s": 9.71904706954956, "pid": 41335, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f5c90e624c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9.71904706954956, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.26428571428571, "ram_util_percent": 83.47857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.824520797787174, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.26221122963814647, "policy_loss": -0.03282315025246271, "vf_loss": 0.28857215455462853, "vf_explained_var": 0.0, "kl": 0.032311129616556765, "entropy": 0.6862132645422413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 31.552999165534978, "episode_reward_min": 21.107124833106997, "episode_reward_mean": 26.649681942386625, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.069124713897708, 26.763999523162845, 23.581124570846555, 23.49556214237213, 27.582561975479127, 23.664124618530277, 25.329562285423282, 23.56756219005585, 26.061561999320983, 22.51012464237213, 25.093124499320986, 24.710562118530273, 22.25699952316284, 21.323562213897706, 24.768999380111694, 23.331999785423278, 24.41056202316284, 23.81112457084656, 23.78299959468841, 22.916124785423282, 24.447562023162845, 24.547124570846556, 24.157561903953553, 22.17212464237213, 25.79456207084656, 27.95556207084656, 27.6149992609024, 22.713562190055846, 21.47756228542328, 26.184999475479124, 27.14456192779541, 26.243561927795415, 22.21656209468842, 27.1031245470047, 24.526562094688412, 21.107124833106997, 25.40556219005585, 26.759561856269837, 27.31656183242798, 22.18968714237213, 23.34056209468841, 25.907561880111697, 25.431124594688416, 24.805124690055848, 24.794562142372133, 25.067561999320986, 23.686124618530272, 26.33199942779541, 22.43256202316284, 25.68156211853027, 25.175562118530276, 24.570999618530273, 25.26399952316284, 23.9819995470047, 23.830999547004698, 23.50812476158142, 27.28212447547913, 26.238999594688416, 24.147999594688418, 23.517562213897705, 25.817562047004703, 25.35756202316284, 23.32399978542328, 25.7545620470047, 25.804562094688418, 24.678124570846563, 26.354562023162842, 26.911561832427985, 25.28056214237213, 24.829124642372125, 24.307687070846562, 25.906999380111696, 23.378124761581418, 25.06556219005585, 26.5545620470047, 25.137999666213986, 25.46056195163727, 23.14656228542328, 22.193562261581423, 25.557562023162845, 24.382562190055843, 24.660562190055845, 25.176124642372127, 23.904999737739566, 21.343999880790705, 25.57212452316284, 21.349562309265135, 23.386999642372132, 22.747999642372132, 24.876561999320984, 25.338562094688417, 24.72612449932098, 26.99956188011169, 22.73899969005585, 21.775562285423277, 24.066562237739564, 26.123561975479124, 25.054124499320984, 24.28499942779541, 25.98556192779541, 22.236124713897702, 23.823562190055842, 22.407999690055853, 24.288124713897705, 23.912562118530275, 26.69199945163727, 27.020561999320986, 23.657999570846556, 26.634561999320987, 25.921561999320982, 25.706561999320986, 24.877562166213984, 24.038561903953557, 26.662561880111696, 23.3049995470047, 25.137999666213986, 25.786999642372134, 25.531124451637268, 23.725999523162844, 27.561561975479126, 21.917562094688417, 23.736999570846557, 25.84399949932098, 28.339124284744265, 25.44199940395355, 28.095561737060546, 30.701561760902404, 29.017561880111696, 29.603561832427978, 27.59756183242798, 29.54856183242798, 27.878999189376835, 30.10956176090241, 26.20612457084656, 29.118999332427975, 29.30812421321869, 28.70612418937683, 28.945561880111693, 28.974124451637266, 27.122999427795406, 29.609562094688414, 27.046999380111693, 27.392561713218694, 27.075999237060547, 28.747561713218687, 29.561999260902404, 29.818124213218695, 30.144999189376833, 28.43112416553497, 27.94699918937684, 29.51856190395355, 27.47956190395356, 27.735999403953546, 28.230124070167538, 26.398124427795413, 30.481561784744265, 30.26199923706055, 25.97556192779541, 29.681999189376832, 30.359999117851252, 30.782561903953553, 26.07212449932098, 29.28599940395355, 26.865999380111695, 28.96956173706054, 29.422999332427974, 28.854999332427983, 28.380124284744262, 27.926561880111695, 27.465999475479123, 28.188999547004702, 29.354999189376834, 30.692124141693117, 29.015999308586125, 28.47556176090241, 28.82956185626983, 29.926686999320985, 27.93156199932098, 27.83012428474426, 30.624124022483823, 25.480562070846556, 30.44999916553497, 26.355561951637267, 28.99856173706054, 27.639124380111692, 31.129999070167543, 30.271124308586117, 29.869561760902403, 27.14312421321869, 28.734124260902405, 27.166124189376823, 26.074999427795408, 29.754124284744265, 29.990561570167543, 30.06699930858612, 31.026999070167538, 30.992561522483825, 29.655124070167542, 26.630686903953553, 27.348999332427976, 27.975561856269834, 30.493561641693116, 29.10056197547913, 29.54212428474426, 31.05712418937683, 29.904999284744264, 29.84268699932099, 28.13256180858612, 28.860124308586126, 31.225124070167542, 28.825561713218693, 27.151124308586123, 26.66499933242797, 25.399562190055853, 26.319124451637265, 27.91999918937683, 30.887561641693114, 26.84256199932098, 29.04856164169312, 31.552999165534978, 29.438561784744266, 29.506124260902407, 28.680999403953557, 28.003999427795414, 27.737124332427978, 28.02156173706055, 25.586124523162837, 27.508561784744263, 30.01656185626984, 29.117561737060548, 28.233561856269837, 30.33956166553497, 25.58312457084656, 30.270999189376834, 29.708561713218693, 28.749124260902402, 27.389561856269836, 27.95699933242798, 28.591124213218684, 30.12099928474427, 29.35199935626984, 28.317561927795413, 29.298999189376826, 27.671561760902406, 25.77756192779541, 27.606999260902406, 28.216561951637274, 25.84656195163727, 29.58612435626984, 28.297124260902407], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.325618919805419, "mean_inference_ms": 1.1116470345494984, "mean_action_processing_ms": 0.12398272626133627, "mean_env_wait_ms": 0.07078725676094405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039475631713867185, "StateBufferConnector_ms": 0.050281715393066403, "ViewRequirementAgentConnector_ms": 0.34063568115234377}}, "episode_reward_max": 31.552999165534978, "episode_reward_min": 21.107124833106997, "episode_reward_mean": 26.649681942386625, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.069124713897708, 26.763999523162845, 23.581124570846555, 23.49556214237213, 27.582561975479127, 23.664124618530277, 25.329562285423282, 23.56756219005585, 26.061561999320983, 22.51012464237213, 25.093124499320986, 24.710562118530273, 22.25699952316284, 21.323562213897706, 24.768999380111694, 23.331999785423278, 24.41056202316284, 23.81112457084656, 23.78299959468841, 22.916124785423282, 24.447562023162845, 24.547124570846556, 24.157561903953553, 22.17212464237213, 25.79456207084656, 27.95556207084656, 27.6149992609024, 22.713562190055846, 21.47756228542328, 26.184999475479124, 27.14456192779541, 26.243561927795415, 22.21656209468842, 27.1031245470047, 24.526562094688412, 21.107124833106997, 25.40556219005585, 26.759561856269837, 27.31656183242798, 22.18968714237213, 23.34056209468841, 25.907561880111697, 25.431124594688416, 24.805124690055848, 24.794562142372133, 25.067561999320986, 23.686124618530272, 26.33199942779541, 22.43256202316284, 25.68156211853027, 25.175562118530276, 24.570999618530273, 25.26399952316284, 23.9819995470047, 23.830999547004698, 23.50812476158142, 27.28212447547913, 26.238999594688416, 24.147999594688418, 23.517562213897705, 25.817562047004703, 25.35756202316284, 23.32399978542328, 25.7545620470047, 25.804562094688418, 24.678124570846563, 26.354562023162842, 26.911561832427985, 25.28056214237213, 24.829124642372125, 24.307687070846562, 25.906999380111696, 23.378124761581418, 25.06556219005585, 26.5545620470047, 25.137999666213986, 25.46056195163727, 23.14656228542328, 22.193562261581423, 25.557562023162845, 24.382562190055843, 24.660562190055845, 25.176124642372127, 23.904999737739566, 21.343999880790705, 25.57212452316284, 21.349562309265135, 23.386999642372132, 22.747999642372132, 24.876561999320984, 25.338562094688417, 24.72612449932098, 26.99956188011169, 22.73899969005585, 21.775562285423277, 24.066562237739564, 26.123561975479124, 25.054124499320984, 24.28499942779541, 25.98556192779541, 22.236124713897702, 23.823562190055842, 22.407999690055853, 24.288124713897705, 23.912562118530275, 26.69199945163727, 27.020561999320986, 23.657999570846556, 26.634561999320987, 25.921561999320982, 25.706561999320986, 24.877562166213984, 24.038561903953557, 26.662561880111696, 23.3049995470047, 25.137999666213986, 25.786999642372134, 25.531124451637268, 23.725999523162844, 27.561561975479126, 21.917562094688417, 23.736999570846557, 25.84399949932098, 28.339124284744265, 25.44199940395355, 28.095561737060546, 30.701561760902404, 29.017561880111696, 29.603561832427978, 27.59756183242798, 29.54856183242798, 27.878999189376835, 30.10956176090241, 26.20612457084656, 29.118999332427975, 29.30812421321869, 28.70612418937683, 28.945561880111693, 28.974124451637266, 27.122999427795406, 29.609562094688414, 27.046999380111693, 27.392561713218694, 27.075999237060547, 28.747561713218687, 29.561999260902404, 29.818124213218695, 30.144999189376833, 28.43112416553497, 27.94699918937684, 29.51856190395355, 27.47956190395356, 27.735999403953546, 28.230124070167538, 26.398124427795413, 30.481561784744265, 30.26199923706055, 25.97556192779541, 29.681999189376832, 30.359999117851252, 30.782561903953553, 26.07212449932098, 29.28599940395355, 26.865999380111695, 28.96956173706054, 29.422999332427974, 28.854999332427983, 28.380124284744262, 27.926561880111695, 27.465999475479123, 28.188999547004702, 29.354999189376834, 30.692124141693117, 29.015999308586125, 28.47556176090241, 28.82956185626983, 29.926686999320985, 27.93156199932098, 27.83012428474426, 30.624124022483823, 25.480562070846556, 30.44999916553497, 26.355561951637267, 28.99856173706054, 27.639124380111692, 31.129999070167543, 30.271124308586117, 29.869561760902403, 27.14312421321869, 28.734124260902405, 27.166124189376823, 26.074999427795408, 29.754124284744265, 29.990561570167543, 30.06699930858612, 31.026999070167538, 30.992561522483825, 29.655124070167542, 26.630686903953553, 27.348999332427976, 27.975561856269834, 30.493561641693116, 29.10056197547913, 29.54212428474426, 31.05712418937683, 29.904999284744264, 29.84268699932099, 28.13256180858612, 28.860124308586126, 31.225124070167542, 28.825561713218693, 27.151124308586123, 26.66499933242797, 25.399562190055853, 26.319124451637265, 27.91999918937683, 30.887561641693114, 26.84256199932098, 29.04856164169312, 31.552999165534978, 29.438561784744266, 29.506124260902407, 28.680999403953557, 28.003999427795414, 27.737124332427978, 28.02156173706055, 25.586124523162837, 27.508561784744263, 30.01656185626984, 29.117561737060548, 28.233561856269837, 30.33956166553497, 25.58312457084656, 30.270999189376834, 29.708561713218693, 28.749124260902402, 27.389561856269836, 27.95699933242798, 28.591124213218684, 30.12099928474427, 29.35199935626984, 28.317561927795413, 29.298999189376826, 27.671561760902406, 25.77756192779541, 27.606999260902406, 28.216561951637274, 25.84656195163727, 29.58612435626984, 28.297124260902407], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.325618919805419, "mean_inference_ms": 1.1116470345494984, "mean_action_processing_ms": 0.12398272626133627, "mean_env_wait_ms": 0.07078725676094405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039475631713867185, "StateBufferConnector_ms": 0.050281715393066403, "ViewRequirementAgentConnector_ms": 0.34063568115234377}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.7001732330692, "num_env_steps_trained_throughput_per_sec": 364.7001732330692, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10337.618, "sample_time_ms": 5340.563, "load_time_ms": 0.349, "load_throughput": 11467680.109, "learn_time_ms": 4993.534, "learn_throughput": 801.036, "synch_weights_time_ms": 2.469}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 470, "training_iteration": 2, "trial_id": "e4724_00000", "date": "2023-08-26_17-05-10", "timestamp": 1693062310, "time_this_iter_s": 10.985332250595093, "time_total_s": 20.704379320144653, "pid": 41335, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f5c90e624c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 20.704379320144653, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 57.431250000000006, "ram_util_percent": 84.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.49119065338245, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23868499791189549, "policy_loss": -0.1515550183132291, "vf_loss": 0.3715357301055744, "vf_explained_var": 0.0, "kl": 0.062347617239122834, "entropy": 0.588807330336622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 31.2985618801117, "episode_reward_min": 19.120249547004697, "episode_reward_mean": 26.24220648234558, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.921999570846552, 24.082562094688413, 28.11356185626984, 23.481999570846558, 24.496999642372135, 25.819561880111703, 22.45356214237213, 25.329561880111697, 27.03199940395355, 28.85099947547912, 25.88212457084656, 24.936124523162842, 26.27812452316284, 24.680562309265138, 24.7425620470047, 21.978562213897703, 24.458999690055844, 24.604999618530268, 21.579562142372133, 24.813124570846558, 21.22812471389771, 26.113999475479122, 23.54312445163727, 24.346999594688416, 22.693999690055847, 26.100561999320984, 22.486562094688413, 24.670999594688414, 22.730999570846553, 26.284561927795412, 21.137124833106995, 26.102686951637263, 26.492999547004697, 25.579124451637266, 22.720562237739557, 23.487562094688414, 24.917999547004698, 22.59099978542327, 26.471561951637263, 22.652124690055846, 22.477562142372133, 24.548124570846557, 28.358124356269837, 26.16012442779541, 22.29299973773956, 26.488562023162842, 23.291562023162843, 26.13556197547913, 24.116562023162846, 21.94856216621399, 25.979999570846555, 24.2299997138977, 25.569999666213995, 24.84812461853027, 25.28699952316284, 26.26599942779541, 24.419999475479127, 23.86312445163727, 26.053562047004696, 26.985124403953552, 24.26499959468842, 24.30556202316284, 23.79012461853027, 24.451999523162844, 24.71256199932098, 25.655561999320987, 23.16256214237213, 25.385562070846554, 24.094124547004704, 26.752562237739568, 24.68012464237213, 22.251562213897703, 22.371562094688418, 23.274999713897703, 22.707562142372133, 23.708562070846558, 25.960561999320987, 23.742562118530277, 23.7265620470047, 22.336562142372127, 24.412562094688415, 23.618562070846558, 20.969562237739567, 24.48399957084656, 24.25356221389771, 27.950686999320983, 23.435562094688414, 25.453561975479126, 25.97399942779541, 21.12412469005585, 22.98099957084656, 22.380124594688414, 23.440999570846557, 26.176999594688414, 24.602561951637266, 27.497562023162843, 22.95312459468842, 26.822561999320982, 26.498124499320987, 26.123561832427974, 25.507999523162837, 23.563562118530278, 23.70056219005585, 26.79056190395355, 22.305562142372132, 21.929562094688418, 23.00212466621399, 25.16456223773956, 24.622999594688416, 24.407561951637266, 25.18512442779541, 23.633562142372128, 20.164124833106996, 22.424562333106998, 26.3295620470047, 24.0785622138977, 25.187999594688414, 22.909999690055848, 24.25912476158142, 24.108562118530276, 24.290124713897704, 23.747999570846552, 23.616124523162842, 26.325561903953552, 26.050124547004692, 23.98368692779541, 28.274561737060544, 27.626999570846554, 28.250999189376838, 31.086999308586122, 31.217124237060546, 27.36756202316284, 26.980561927795414, 27.45868695163726, 26.85856192779541, 27.40656199932098, 30.343561808586124, 26.39856197547913, 28.10799923706055, 26.92712461853028, 27.471124523162842, 29.433999308586117, 27.732561832427976, 27.904124141693114, 28.137124547004696, 31.265999237060548, 26.404124451637266, 27.537124451637276, 28.65812445163727, 25.750124475479126, 26.673561975479124, 28.717124237060542, 28.64299928474426, 24.93856211853027, 30.237999189376833, 23.740687047004702, 25.707999570846557, 29.611999284744265, 25.09056192779541, 27.408561975479124, 23.72468714237213, 30.331561808586123, 28.962561760902403, 28.77199933242798, 27.691999356269832, 28.601999403953556, 26.930124260902407, 27.56512445163727, 27.826561999320983, 28.69212428474426, 25.84656192779541, 27.61968697547912, 29.950124308586126, 27.230561975479127, 25.244999475479126, 28.87999940395355, 28.980999308586124, 28.10299930858612, 29.357561856269836, 29.60856190395355, 28.847999213218692, 28.44612428474426, 29.390561880111697, 28.837999380111693, 25.40212449932098, 29.23256185626984, 19.120249547004697, 26.32556190395355, 27.72456202316284, 25.23056199932098, 26.038562023162847, 26.12599942779541, 26.370562070846553, 27.482999451637266, 27.238562094688422, 24.91368719005585, 27.93556176090241, 28.809999523162844, 31.2985618801117, 29.77356173706055, 28.96756185626984, 28.894561927795415, 26.66312452316284, 29.810561641693113, 29.582999475479124, 25.94356195163727, 26.878124380111693, 28.826561927795414, 29.08768707084656, 29.706999356269836, 29.60156178474426, 29.283562047004704, 28.125124308586123, 28.99512418937683, 28.485561975479126, 27.4735620470047, 26.1629995470047, 26.8005618801117, 26.939124332427973, 31.098561737060542, 28.12299942779541, 29.437999308586114, 25.112124618530274, 29.220124308586115, 30.195561975479123, 29.74599933242797, 28.512561856269834, 27.73456183242798, 27.737999380111695, 29.328999237060543, 29.39556192779541, 30.9816865940094, 31.153561570167536, 28.202561927795408, 29.523561856269836, 30.21912416553497, 27.79812442779541, 29.611124380111697, 28.9915617609024, 28.966124308586124, 27.08856192779541, 28.493124332427975, 30.60912428474426, 25.966561856269834, 28.230124356269837, 29.64456173706055, 31.047561689376828, 27.807124260902405, 28.395124427795412, 27.12299942779541], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2809122588073902, "mean_inference_ms": 1.0400839277832254, "mean_action_processing_ms": 0.1171993585531562, "mean_env_wait_ms": 0.06715539415127793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027376651763916016, "StateBufferConnector_ms": 0.03596687316894531, "ViewRequirementAgentConnector_ms": 0.24248876571655273}}, "episode_reward_max": 31.2985618801117, "episode_reward_min": 19.120249547004697, "episode_reward_mean": 26.24220648234558, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.921999570846552, 24.082562094688413, 28.11356185626984, 23.481999570846558, 24.496999642372135, 25.819561880111703, 22.45356214237213, 25.329561880111697, 27.03199940395355, 28.85099947547912, 25.88212457084656, 24.936124523162842, 26.27812452316284, 24.680562309265138, 24.7425620470047, 21.978562213897703, 24.458999690055844, 24.604999618530268, 21.579562142372133, 24.813124570846558, 21.22812471389771, 26.113999475479122, 23.54312445163727, 24.346999594688416, 22.693999690055847, 26.100561999320984, 22.486562094688413, 24.670999594688414, 22.730999570846553, 26.284561927795412, 21.137124833106995, 26.102686951637263, 26.492999547004697, 25.579124451637266, 22.720562237739557, 23.487562094688414, 24.917999547004698, 22.59099978542327, 26.471561951637263, 22.652124690055846, 22.477562142372133, 24.548124570846557, 28.358124356269837, 26.16012442779541, 22.29299973773956, 26.488562023162842, 23.291562023162843, 26.13556197547913, 24.116562023162846, 21.94856216621399, 25.979999570846555, 24.2299997138977, 25.569999666213995, 24.84812461853027, 25.28699952316284, 26.26599942779541, 24.419999475479127, 23.86312445163727, 26.053562047004696, 26.985124403953552, 24.26499959468842, 24.30556202316284, 23.79012461853027, 24.451999523162844, 24.71256199932098, 25.655561999320987, 23.16256214237213, 25.385562070846554, 24.094124547004704, 26.752562237739568, 24.68012464237213, 22.251562213897703, 22.371562094688418, 23.274999713897703, 22.707562142372133, 23.708562070846558, 25.960561999320987, 23.742562118530277, 23.7265620470047, 22.336562142372127, 24.412562094688415, 23.618562070846558, 20.969562237739567, 24.48399957084656, 24.25356221389771, 27.950686999320983, 23.435562094688414, 25.453561975479126, 25.97399942779541, 21.12412469005585, 22.98099957084656, 22.380124594688414, 23.440999570846557, 26.176999594688414, 24.602561951637266, 27.497562023162843, 22.95312459468842, 26.822561999320982, 26.498124499320987, 26.123561832427974, 25.507999523162837, 23.563562118530278, 23.70056219005585, 26.79056190395355, 22.305562142372132, 21.929562094688418, 23.00212466621399, 25.16456223773956, 24.622999594688416, 24.407561951637266, 25.18512442779541, 23.633562142372128, 20.164124833106996, 22.424562333106998, 26.3295620470047, 24.0785622138977, 25.187999594688414, 22.909999690055848, 24.25912476158142, 24.108562118530276, 24.290124713897704, 23.747999570846552, 23.616124523162842, 26.325561903953552, 26.050124547004692, 23.98368692779541, 28.274561737060544, 27.626999570846554, 28.250999189376838, 31.086999308586122, 31.217124237060546, 27.36756202316284, 26.980561927795414, 27.45868695163726, 26.85856192779541, 27.40656199932098, 30.343561808586124, 26.39856197547913, 28.10799923706055, 26.92712461853028, 27.471124523162842, 29.433999308586117, 27.732561832427976, 27.904124141693114, 28.137124547004696, 31.265999237060548, 26.404124451637266, 27.537124451637276, 28.65812445163727, 25.750124475479126, 26.673561975479124, 28.717124237060542, 28.64299928474426, 24.93856211853027, 30.237999189376833, 23.740687047004702, 25.707999570846557, 29.611999284744265, 25.09056192779541, 27.408561975479124, 23.72468714237213, 30.331561808586123, 28.962561760902403, 28.77199933242798, 27.691999356269832, 28.601999403953556, 26.930124260902407, 27.56512445163727, 27.826561999320983, 28.69212428474426, 25.84656192779541, 27.61968697547912, 29.950124308586126, 27.230561975479127, 25.244999475479126, 28.87999940395355, 28.980999308586124, 28.10299930858612, 29.357561856269836, 29.60856190395355, 28.847999213218692, 28.44612428474426, 29.390561880111697, 28.837999380111693, 25.40212449932098, 29.23256185626984, 19.120249547004697, 26.32556190395355, 27.72456202316284, 25.23056199932098, 26.038562023162847, 26.12599942779541, 26.370562070846553, 27.482999451637266, 27.238562094688422, 24.91368719005585, 27.93556176090241, 28.809999523162844, 31.2985618801117, 29.77356173706055, 28.96756185626984, 28.894561927795415, 26.66312452316284, 29.810561641693113, 29.582999475479124, 25.94356195163727, 26.878124380111693, 28.826561927795414, 29.08768707084656, 29.706999356269836, 29.60156178474426, 29.283562047004704, 28.125124308586123, 28.99512418937683, 28.485561975479126, 27.4735620470047, 26.1629995470047, 26.8005618801117, 26.939124332427973, 31.098561737060542, 28.12299942779541, 29.437999308586114, 25.112124618530274, 29.220124308586115, 30.195561975479123, 29.74599933242797, 28.512561856269834, 27.73456183242798, 27.737999380111695, 29.328999237060543, 29.39556192779541, 30.9816865940094, 31.153561570167536, 28.202561927795408, 29.523561856269836, 30.21912416553497, 27.79812442779541, 29.611124380111697, 28.9915617609024, 28.966124308586124, 27.08856192779541, 28.493124332427975, 30.60912428474426, 25.966561856269834, 28.230124356269837, 29.64456173706055, 31.047561689376828, 27.807124260902405, 28.395124427795412, 27.12299942779541], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2809122588073902, "mean_inference_ms": 1.0400839277832254, "mean_action_processing_ms": 0.1171993585531562, "mean_env_wait_ms": 0.06715539415127793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027376651763916016, "StateBufferConnector_ms": 0.03596687316894531, "ViewRequirementAgentConnector_ms": 0.24248876571655273}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.2550802137585, "num_env_steps_trained_throughput_per_sec": 414.2550802137585, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10110.365, "sample_time_ms": 5072.986, "load_time_ms": 0.332, "load_throughput": 12058372.784, "learn_time_ms": 5033.938, "learn_throughput": 794.607, "synch_weights_time_ms": 2.413}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": true, "episodes_total": 720, "training_iteration": 3, "trial_id": "e4724_00000", "date": "2023-08-26_17-05-20", "timestamp": 1693062320, "time_this_iter_s": 9.669784784317017, "time_total_s": 30.37416410446167, "pid": 41335, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f5c90e624c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 30.37416410446167, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.44285714285714, "ram_util_percent": 83.78571428571426}}
