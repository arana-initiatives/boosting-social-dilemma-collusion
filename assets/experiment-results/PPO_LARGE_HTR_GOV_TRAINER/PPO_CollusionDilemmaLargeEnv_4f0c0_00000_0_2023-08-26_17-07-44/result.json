{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.495075687461643, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.548253628451337, "policy_loss": -0.004755397509503108, "vf_loss": 1.5518674677418125, "vf_explained_var": -0.0013096858737289266, "kl": 0.005707795530946841, "entropy": 0.687574145678551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 435.94598981952646, "episode_reward_min": 20.742562166213993, "episode_reward_mean": 30.0286874634656, "episode_len_mean": 18.181818181818183, "episode_media": {}, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [413.8692424659729, 25.512562070846556, 27.14256199932098, 26.093999547004707, 28.19056180858612, 25.402124761581423, 27.236561784744268, 24.340124523162846, 26.026999451637266, 24.97599949932098, 24.550999523162844, 25.1029995470047, 25.965999451637266, 24.7485620470047, 28.337561880111693, 27.701561832427984, 25.87656199932098, 24.94599961853027, 26.68256180858612, 24.402124451637267, 26.319124451637272, 23.518999475479127, 26.65756207084656, 24.833999690055848, 25.171686999320983, 24.538124380111693, 26.06056197547913, 22.811562309265135, 25.340124451637266, 24.737999570846558, 27.967999451637276, 25.784561903953545, 24.15256202316284, 29.56056168937683, 27.42156178474426, 22.07856228542328, 25.606561903953555, 25.278124594688414, 24.860124523162845, 24.871562047004698, 28.797124213218684, 24.39699971389771, 21.941124737739564, 24.61312464237214, 23.275999547004698, 25.536562142372127, 26.81612449932098, 25.65912452316284, 25.557124523162845, 26.659999594688415, 23.334562094688415, 26.404561903953546, 23.643124523162843, 26.41712428474427, 26.54099940395355, 26.708561927795408, 22.650562213897704, 23.80399966621399, 25.931124547004696, 20.742562166213993, 21.415124618530278, 25.77012445163727, 26.009124475479123, 23.966124499320987, 25.25456195163727, 24.582562023162843, 27.017124380111696, 26.13256195163727, 26.925561760902408, 23.33156214237213, 21.877124833106997, 22.65799969005585, 26.49556195163727, 22.318562213897707, 26.008124570846554, 24.149999451637267, 25.680999690055845, 26.055562094688415, 28.962561689376834, 25.514124427795405, 27.120999475479127, 26.284999332427983, 24.681124547004703, 26.415561903953552, 26.416999475479134, 28.319561880111692, 22.42456209468842, 26.677124380111692, 23.33712464237213, 25.612999499320978, 26.562561784744265, 26.3189995470047, 24.78156214237213, 23.98812457084656, 27.0505618801117, 26.52012440395355, 26.407687333107, 27.959999380111693, 26.972562070846553, 28.332561737060548, 21.99656228542328, 25.074999642372134, 23.856999737739564, 24.530124570846557, 26.664124451637267, 27.104999523162842, 25.106124451637267, 27.39712435626984, 26.475999475479128, 25.262562023162847, 435.94598981952646, 28.664561784744265, 28.545561665534972, 27.357124547004695, 27.73999952316284, 28.953561689376833, 26.532999332427977, 25.65012452316285, 28.242561856269838, 27.669999499320987, 24.84256199932099, 31.140124189376827, 23.57212469005585, 30.21056171321869, 30.09512442779541, 26.066562047004698, 25.190561903953554, 29.372561737060543, 28.631999237060548, 25.635561927795408, 27.325124451637265, 27.205124475479124, 29.033124380111694, 26.71299952316284, 26.500686951637267, 28.46256183242798, 28.39712428474427, 29.049687047004696, 27.90912426090241, 27.41056202316284, 27.4535618801117, 24.67668699932098, 28.762561856269837, 29.10299916553497, 25.1336872138977, 27.574124570846557, 26.183999594688416, 27.161561903953558, 28.953124451637272, 26.955561951637268, 25.40756214237212, 26.803999380111694, 29.61056171321869, 29.12699930858612, 25.409562070846558, 28.871124451637264, 28.882999284744262, 25.701999618530277, 28.773561737060547, 27.395561903953556, 30.10756185626984, 26.757124499320984, 28.069999427795405, 25.900124523162845, 28.16999947547913, 27.161999547004704, 30.21456180858612, 26.536999570846554, 31.185561641693113, 29.147561737060546, 25.68256188011169, 28.39612452316284, 27.73056183242798, 28.570999237060548, 30.297561856269837, 25.015562142372136, 28.974561760902407, 27.787561999320985, 25.185562142372127, 27.73399945163727, 27.52156197547913, 27.0111245470047, 26.58056190395355, 23.70212476158142, 28.082561856269834, 24.849562070846556, 26.026999523162843, 27.801999451637265, 29.098561951637272, 23.564687190055846, 29.92456199932098, 26.846999380111697, 26.16612445163727, 28.30812430858612, 26.57899940395355, 27.7479992609024, 26.453124451637265, 26.302999547004696, 26.220999499320985, 30.180561808586127, 25.89356207084656, 23.424124785423277, 26.50412464237213, 24.5971245470047, 29.150561880111695, 26.204124284744264, 30.524124332427977, 26.66612445163727, 28.572561760902406, 26.410124475479122, 28.290999403953553, 24.998124570846556, 26.574561903953548, 27.728999427795408, 25.036561999320977, 25.73056190395355, 26.72912445163727, 24.628124499320986, 28.640561951637267, 26.513561832427975], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0554722581488798, "mean_inference_ms": 0.9602619849819355, "mean_action_processing_ms": 0.10844083621107538, "mean_env_wait_ms": 0.06575592752101123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028624317862770775, "StateBufferConnector_ms": 0.03686742349104448, "ViewRequirementAgentConnector_ms": 0.2397862347689542}}, "episode_reward_max": 435.94598981952646, "episode_reward_min": 20.742562166213993, "episode_reward_mean": 30.0286874634656, "episode_len_mean": 18.181818181818183, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [413.8692424659729, 25.512562070846556, 27.14256199932098, 26.093999547004707, 28.19056180858612, 25.402124761581423, 27.236561784744268, 24.340124523162846, 26.026999451637266, 24.97599949932098, 24.550999523162844, 25.1029995470047, 25.965999451637266, 24.7485620470047, 28.337561880111693, 27.701561832427984, 25.87656199932098, 24.94599961853027, 26.68256180858612, 24.402124451637267, 26.319124451637272, 23.518999475479127, 26.65756207084656, 24.833999690055848, 25.171686999320983, 24.538124380111693, 26.06056197547913, 22.811562309265135, 25.340124451637266, 24.737999570846558, 27.967999451637276, 25.784561903953545, 24.15256202316284, 29.56056168937683, 27.42156178474426, 22.07856228542328, 25.606561903953555, 25.278124594688414, 24.860124523162845, 24.871562047004698, 28.797124213218684, 24.39699971389771, 21.941124737739564, 24.61312464237214, 23.275999547004698, 25.536562142372127, 26.81612449932098, 25.65912452316284, 25.557124523162845, 26.659999594688415, 23.334562094688415, 26.404561903953546, 23.643124523162843, 26.41712428474427, 26.54099940395355, 26.708561927795408, 22.650562213897704, 23.80399966621399, 25.931124547004696, 20.742562166213993, 21.415124618530278, 25.77012445163727, 26.009124475479123, 23.966124499320987, 25.25456195163727, 24.582562023162843, 27.017124380111696, 26.13256195163727, 26.925561760902408, 23.33156214237213, 21.877124833106997, 22.65799969005585, 26.49556195163727, 22.318562213897707, 26.008124570846554, 24.149999451637267, 25.680999690055845, 26.055562094688415, 28.962561689376834, 25.514124427795405, 27.120999475479127, 26.284999332427983, 24.681124547004703, 26.415561903953552, 26.416999475479134, 28.319561880111692, 22.42456209468842, 26.677124380111692, 23.33712464237213, 25.612999499320978, 26.562561784744265, 26.3189995470047, 24.78156214237213, 23.98812457084656, 27.0505618801117, 26.52012440395355, 26.407687333107, 27.959999380111693, 26.972562070846553, 28.332561737060548, 21.99656228542328, 25.074999642372134, 23.856999737739564, 24.530124570846557, 26.664124451637267, 27.104999523162842, 25.106124451637267, 27.39712435626984, 26.475999475479128, 25.262562023162847, 435.94598981952646, 28.664561784744265, 28.545561665534972, 27.357124547004695, 27.73999952316284, 28.953561689376833, 26.532999332427977, 25.65012452316285, 28.242561856269838, 27.669999499320987, 24.84256199932099, 31.140124189376827, 23.57212469005585, 30.21056171321869, 30.09512442779541, 26.066562047004698, 25.190561903953554, 29.372561737060543, 28.631999237060548, 25.635561927795408, 27.325124451637265, 27.205124475479124, 29.033124380111694, 26.71299952316284, 26.500686951637267, 28.46256183242798, 28.39712428474427, 29.049687047004696, 27.90912426090241, 27.41056202316284, 27.4535618801117, 24.67668699932098, 28.762561856269837, 29.10299916553497, 25.1336872138977, 27.574124570846557, 26.183999594688416, 27.161561903953558, 28.953124451637272, 26.955561951637268, 25.40756214237212, 26.803999380111694, 29.61056171321869, 29.12699930858612, 25.409562070846558, 28.871124451637264, 28.882999284744262, 25.701999618530277, 28.773561737060547, 27.395561903953556, 30.10756185626984, 26.757124499320984, 28.069999427795405, 25.900124523162845, 28.16999947547913, 27.161999547004704, 30.21456180858612, 26.536999570846554, 31.185561641693113, 29.147561737060546, 25.68256188011169, 28.39612452316284, 27.73056183242798, 28.570999237060548, 30.297561856269837, 25.015562142372136, 28.974561760902407, 27.787561999320985, 25.185562142372127, 27.73399945163727, 27.52156197547913, 27.0111245470047, 26.58056190395355, 23.70212476158142, 28.082561856269834, 24.849562070846556, 26.026999523162843, 27.801999451637265, 29.098561951637272, 23.564687190055846, 29.92456199932098, 26.846999380111697, 26.16612445163727, 28.30812430858612, 26.57899940395355, 27.7479992609024, 26.453124451637265, 26.302999547004696, 26.220999499320985, 30.180561808586127, 25.89356207084656, 23.424124785423277, 26.50412464237213, 24.5971245470047, 29.150561880111695, 26.204124284744264, 30.524124332427977, 26.66612445163727, 28.572561760902406, 26.410124475479122, 28.290999403953553, 24.998124570846556, 26.574561903953548, 27.728999427795408, 25.036561999320977, 25.73056190395355, 26.72912445163727, 24.628124499320986, 28.640561951637267, 26.513561832427975], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0554722581488798, "mean_inference_ms": 0.9602619849819355, "mean_action_processing_ms": 0.10844083621107538, "mean_env_wait_ms": 0.06575592752101123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028624317862770775, "StateBufferConnector_ms": 0.03686742349104448, "ViewRequirementAgentConnector_ms": 0.2397862347689542}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.0762311608173, "num_env_steps_trained_throughput_per_sec": 444.0762311608173, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 9007.43, "sample_time_ms": 4434.145, "load_time_ms": 0.365, "load_throughput": 10951185.379, "learn_time_ms": 4570.482, "learn_throughput": 875.181, "synch_weights_time_ms": 1.801}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 220, "training_iteration": 1, "trial_id": "4f0c0_00000", "date": "2023-08-26_17-07-58", "timestamp": 1693062478, "time_this_iter_s": 9.018147468566895, "time_total_s": 9.018147468566895, "pid": 42822, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa912fb04c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9.018147468566895, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.22307692307693, "ram_util_percent": 87.76153846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0498993967809986, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2780942068024669, "policy_loss": -0.013664985708491777, "vf_loss": 0.28570598097898625, "vf_explained_var": 0.0, "kl": 0.030266061864551188, "entropy": 0.6840809765041516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 31.143999189376828, "episode_reward_min": 20.2816872138977, "episode_reward_mean": 26.691809193244932, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.25756207084656, 25.461999380111696, 25.249124570846558, 25.8435620470047, 26.06599942779541, 25.78799945163727, 28.011561880111692, 27.014124547004702, 28.244561999320982, 25.566124451637272, 24.17999952316284, 27.779562070846556, 24.48599952316284, 23.527124642372133, 23.586562070846554, 26.810124260902406, 26.279561903953557, 26.824999380111695, 23.278999690055844, 25.885124427795407, 25.79399964237213, 24.162124713897704, 24.72112457084656, 23.273999666213985, 24.308124475479126, 25.769999475479125, 24.946562166213987, 27.402999499320984, 24.341124594688413, 24.24956202316284, 26.875561832427977, 28.404999356269833, 24.90299961853027, 27.207999427795407, 26.833561880111695, 25.51912438011169, 26.30956195163727, 26.489124523162843, 25.208999403953555, 23.869999594688412, 25.745999499320988, 26.159999666213988, 27.667999260902405, 27.404999308586127, 26.10712435626984, 24.8309995470047, 26.728561951637264, 25.040562118530275, 26.234561903953555, 26.097999570846554, 28.64856183242798, 24.881561832427977, 26.9901243801117, 25.561999642372133, 24.795999570846558, 26.017124403953552, 25.977999499320983, 24.410687213897702, 20.2816872138977, 26.49899930858612, 23.984562118530278, 24.887561951637267, 24.27699959468841, 26.946561999320988, 26.94312452316284, 28.448999237060548, 23.99312452316284, 27.064999308586124, 26.168561903953552, 24.442561975479126, 25.080562118530278, 24.629562094688414, 23.819124690055848, 25.198562094688413, 26.43799952316284, 26.705999451637275, 24.940999547004704, 25.2195620470047, 23.36099961853028, 23.880562118530275, 25.896999380111694, 26.670124332427978, 26.089124618530274, 28.013999427795408, 22.797124737739562, 24.253562094688416, 25.558561999320982, 25.642124451637265, 24.907124499320982, 22.726124666213984, 25.706561903953553, 26.13056192779541, 27.288561880111697, 26.737999403953555, 25.42856202316284, 23.009562094688413, 23.748999690055854, 26.704124642372136, 24.887999618530277, 23.54812457084656, 26.07212449932099, 23.7325620470047, 26.09299966621399, 26.273562047004706, 26.235999475479133, 24.61756199932099, 25.674999570846555, 27.602124499320983, 27.565561903953558, 30.186561760902407, 25.90699964237213, 24.670124499320977, 24.64556195163727, 24.13712466621399, 26.51499940395355, 26.427999475479126, 27.30656178474426, 25.00356195163727, 22.389124642372135, 26.929562118530274, 25.0141245470047, 25.416562094688413, 25.57656202316284, 26.951124451637263, 26.060999547004705, 26.464124570846554, 30.74399940395355, 27.120999403953554, 29.69556178474426, 27.359562023162844, 27.921561760902403, 28.391561784744265, 28.995124213218688, 29.20256178474426, 28.141561880111688, 29.741561760902414, 26.295561975479124, 29.61399921321868, 27.682686903953556, 26.924561951637273, 29.03912430858612, 26.27199930858612, 28.485124451637265, 29.613561856269833, 30.847561689376832, 26.72856209468841, 28.758999213218686, 29.87556180858612, 28.805124403953553, 27.332999475479127, 27.81256202316284, 28.263999475479128, 29.71799921321869, 27.246124284744262, 26.469999451637264, 26.65056211853027, 29.447124213218693, 25.607561903953556, 30.461561641693116, 27.622999475479126, 28.624124475479128, 26.31456188011169, 26.888561927795415, 25.950999499320986, 26.05956188011169, 28.33156185626984, 31.143999189376828, 26.766562094688414, 30.498124213218688, 26.137561999320983, 27.1675617609024, 26.76756192779541, 29.790561760902403, 27.863561760902407, 28.72256183242798, 29.04756188011169, 28.5141243801117, 28.263999356269835, 26.727561903953553, 27.363562023162842, 28.359999332427982, 27.970561832427983, 30.896561760902404, 28.35956185626984, 25.231124547004704, 27.02256188011169, 26.597562094688417, 29.555999356269837, 29.231124451637267, 29.85956178474427, 24.206124594688422, 25.87368699932098, 25.81156207084656, 28.596124213218687, 26.393561903953554, 25.81199945163727, 27.519999284744266, 28.186999499320983, 29.442124213218683, 27.158561903953554, 28.162999356269836, 29.580999165534976, 25.824561975479128, 25.87356199932098, 27.96712423706055, 27.66699933242798, 28.76056195163727, 26.168561975479125, 26.499124403953555, 28.04056176090241, 25.53112454700471, 26.571561880111695, 27.775999260902402, 28.625561784744264, 29.260124356269834, 25.564124618530276, 29.7135617609024, 26.414999332427982, 27.609999403953555, 27.918561903953552, 28.355124284744267, 26.708561951637268, 29.02156164169312, 28.139124427795405, 29.550561760902404, 21.630124690055847, 31.01556157016754, 26.31056199932098, 29.052561808586116, 28.156561880111695, 27.465561713218687, 26.664562070846557, 27.31999935626984, 27.16356192779541, 28.725999451637268, 27.247999427795406, 26.213999308586125, 27.697561784744266, 26.361562142372126, 27.187124475479127, 28.427999356269837, 25.50456195163727, 26.79356197547913, 26.899999332427978, 29.121561808586115, 27.792124237060545, 29.171561880111696, 25.476562023162842, 30.508999094009397, 25.354999642372135], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.246862875107258, "mean_inference_ms": 1.0856629550173953, "mean_action_processing_ms": 0.12135407353186423, "mean_env_wait_ms": 0.07078770368404909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03416872024536133, "StateBufferConnector_ms": 0.04608345031738281, "ViewRequirementAgentConnector_ms": 0.30639171600341797}}, "episode_reward_max": 31.143999189376828, "episode_reward_min": 20.2816872138977, "episode_reward_mean": 26.691809193244932, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.25756207084656, 25.461999380111696, 25.249124570846558, 25.8435620470047, 26.06599942779541, 25.78799945163727, 28.011561880111692, 27.014124547004702, 28.244561999320982, 25.566124451637272, 24.17999952316284, 27.779562070846556, 24.48599952316284, 23.527124642372133, 23.586562070846554, 26.810124260902406, 26.279561903953557, 26.824999380111695, 23.278999690055844, 25.885124427795407, 25.79399964237213, 24.162124713897704, 24.72112457084656, 23.273999666213985, 24.308124475479126, 25.769999475479125, 24.946562166213987, 27.402999499320984, 24.341124594688413, 24.24956202316284, 26.875561832427977, 28.404999356269833, 24.90299961853027, 27.207999427795407, 26.833561880111695, 25.51912438011169, 26.30956195163727, 26.489124523162843, 25.208999403953555, 23.869999594688412, 25.745999499320988, 26.159999666213988, 27.667999260902405, 27.404999308586127, 26.10712435626984, 24.8309995470047, 26.728561951637264, 25.040562118530275, 26.234561903953555, 26.097999570846554, 28.64856183242798, 24.881561832427977, 26.9901243801117, 25.561999642372133, 24.795999570846558, 26.017124403953552, 25.977999499320983, 24.410687213897702, 20.2816872138977, 26.49899930858612, 23.984562118530278, 24.887561951637267, 24.27699959468841, 26.946561999320988, 26.94312452316284, 28.448999237060548, 23.99312452316284, 27.064999308586124, 26.168561903953552, 24.442561975479126, 25.080562118530278, 24.629562094688414, 23.819124690055848, 25.198562094688413, 26.43799952316284, 26.705999451637275, 24.940999547004704, 25.2195620470047, 23.36099961853028, 23.880562118530275, 25.896999380111694, 26.670124332427978, 26.089124618530274, 28.013999427795408, 22.797124737739562, 24.253562094688416, 25.558561999320982, 25.642124451637265, 24.907124499320982, 22.726124666213984, 25.706561903953553, 26.13056192779541, 27.288561880111697, 26.737999403953555, 25.42856202316284, 23.009562094688413, 23.748999690055854, 26.704124642372136, 24.887999618530277, 23.54812457084656, 26.07212449932099, 23.7325620470047, 26.09299966621399, 26.273562047004706, 26.235999475479133, 24.61756199932099, 25.674999570846555, 27.602124499320983, 27.565561903953558, 30.186561760902407, 25.90699964237213, 24.670124499320977, 24.64556195163727, 24.13712466621399, 26.51499940395355, 26.427999475479126, 27.30656178474426, 25.00356195163727, 22.389124642372135, 26.929562118530274, 25.0141245470047, 25.416562094688413, 25.57656202316284, 26.951124451637263, 26.060999547004705, 26.464124570846554, 30.74399940395355, 27.120999403953554, 29.69556178474426, 27.359562023162844, 27.921561760902403, 28.391561784744265, 28.995124213218688, 29.20256178474426, 28.141561880111688, 29.741561760902414, 26.295561975479124, 29.61399921321868, 27.682686903953556, 26.924561951637273, 29.03912430858612, 26.27199930858612, 28.485124451637265, 29.613561856269833, 30.847561689376832, 26.72856209468841, 28.758999213218686, 29.87556180858612, 28.805124403953553, 27.332999475479127, 27.81256202316284, 28.263999475479128, 29.71799921321869, 27.246124284744262, 26.469999451637264, 26.65056211853027, 29.447124213218693, 25.607561903953556, 30.461561641693116, 27.622999475479126, 28.624124475479128, 26.31456188011169, 26.888561927795415, 25.950999499320986, 26.05956188011169, 28.33156185626984, 31.143999189376828, 26.766562094688414, 30.498124213218688, 26.137561999320983, 27.1675617609024, 26.76756192779541, 29.790561760902403, 27.863561760902407, 28.72256183242798, 29.04756188011169, 28.5141243801117, 28.263999356269835, 26.727561903953553, 27.363562023162842, 28.359999332427982, 27.970561832427983, 30.896561760902404, 28.35956185626984, 25.231124547004704, 27.02256188011169, 26.597562094688417, 29.555999356269837, 29.231124451637267, 29.85956178474427, 24.206124594688422, 25.87368699932098, 25.81156207084656, 28.596124213218687, 26.393561903953554, 25.81199945163727, 27.519999284744266, 28.186999499320983, 29.442124213218683, 27.158561903953554, 28.162999356269836, 29.580999165534976, 25.824561975479128, 25.87356199932098, 27.96712423706055, 27.66699933242798, 28.76056195163727, 26.168561975479125, 26.499124403953555, 28.04056176090241, 25.53112454700471, 26.571561880111695, 27.775999260902402, 28.625561784744264, 29.260124356269834, 25.564124618530276, 29.7135617609024, 26.414999332427982, 27.609999403953555, 27.918561903953552, 28.355124284744267, 26.708561951637268, 29.02156164169312, 28.139124427795405, 29.550561760902404, 21.630124690055847, 31.01556157016754, 26.31056199932098, 29.052561808586116, 28.156561880111695, 27.465561713218687, 26.664562070846557, 27.31999935626984, 27.16356192779541, 28.725999451637268, 27.247999427795406, 26.213999308586125, 27.697561784744266, 26.361562142372126, 27.187124475479127, 28.427999356269837, 25.50456195163727, 26.79356197547913, 26.899999332427978, 29.121561808586115, 27.792124237060545, 29.171561880111696, 25.476562023162842, 30.508999094009397, 25.354999642372135], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.246862875107258, "mean_inference_ms": 1.0856629550173953, "mean_action_processing_ms": 0.12135407353186423, "mean_env_wait_ms": 0.07078770368404909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03416872024536133, "StateBufferConnector_ms": 0.04608345031738281, "ViewRequirementAgentConnector_ms": 0.30639171600341797}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.61796362948814, "num_env_steps_trained_throughput_per_sec": 334.61796362948814, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10480.664, "sample_time_ms": 5101.475, "load_time_ms": 0.402, "load_throughput": 9950899.17, "learn_time_ms": 5375.815, "learn_throughput": 744.073, "synch_weights_time_ms": 2.245}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 470, "training_iteration": 2, "trial_id": "4f0c0_00000", "date": "2023-08-26_17-08-10", "timestamp": 1693062490, "time_this_iter_s": 11.967530250549316, "time_total_s": 20.98567771911621, "pid": 42822, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa912fb04c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 20.98567771911621, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 68.79411764705884, "ram_util_percent": 87.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8833141681567955, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23105773024401197, "policy_loss": -0.1343834050500425, "vf_loss": 0.34692949261716616, "vf_explained_var": 0.0, "kl": 0.0617054780556169, "entropy": 0.5829624156157176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 31.15956157016754, "episode_reward_min": 20.52256219005585, "episode_reward_mean": 26.22511624169159, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.898999523162843, 23.669562070846556, 28.807561737060546, 26.338999308586125, 26.381124475479126, 26.998999499320984, 27.131687166213993, 24.353999594688414, 24.054562047004698, 24.023124594688422, 24.126124833106996, 24.8799995470047, 24.324562094688417, 21.497562190055845, 23.366999594688416, 26.545999594688418, 28.148999427795417, 28.480686975479127, 25.63912459468841, 24.076124547004703, 25.878999499320987, 25.61912442779541, 26.99212430858612, 25.591561880111687, 25.52656202316284, 24.85856211853027, 24.99256211853027, 27.23512459468842, 26.063561975479125, 22.115124618530274, 24.446562094688414, 25.778999475479132, 24.715562070846552, 26.360999451637266, 25.462561784744263, 25.728999499320985, 28.28856207084656, 24.7445620470047, 24.521562023162844, 26.338999594688417, 23.602999618530273, 23.028124642372134, 25.33112459468841, 25.315999499320984, 26.272562023162845, 25.951562047004696, 27.622999475479123, 24.686562118530283, 26.781561808586122, 25.56256202316284, 27.27756197547913, 26.264124403953552, 24.64556226158142, 24.887561951637267, 22.16768699932098, 28.61268680858612, 25.62556219005585, 25.219999666213987, 26.992561880111694, 24.533999523162848, 24.61512461853027, 26.09456211853027, 22.71756226158142, 26.130999618530275, 25.24256195163727, 26.02812442779541, 24.86756216621399, 26.75399949932099, 27.482561832427983, 23.79556207084656, 29.220561856269832, 26.128999499320983, 27.789561999320988, 25.804561880111695, 26.15799952316284, 26.82812445163727, 24.58056207084656, 23.28612461853027, 26.208562070846558, 27.78356195163727, 26.028124570846554, 29.05012433242798, 24.615999570846554, 24.632562070846557, 25.788561999320983, 24.027124833106992, 24.68656219005584, 27.177999499320986, 20.52256219005585, 22.820999403953554, 25.15156192779541, 25.30412447547912, 25.665562190055844, 26.906124570846558, 22.3565622138977, 23.749562118530278, 22.97956226158142, 26.50199945163726, 25.741562070846562, 24.862562285423277, 26.254999547004697, 23.951562094688413, 24.146124618530273, 22.995999618530274, 25.18456188011169, 26.77556199932098, 27.88756192779541, 25.00256219005584, 21.359562333106993, 26.885686951637275, 25.88912457084655, 24.744124523162842, 25.654999475479126, 25.922999618530277, 24.412562023162838, 27.91012442779541, 26.244124475479122, 25.37099952316284, 25.78056211853027, 22.8565620470047, 26.076124547004696, 24.451562142372126, 26.19168697547913, 21.509562118530276, 28.430999332427977, 25.05312466621399, 27.01656197547912, 25.302124618530275, 24.711562118530274, 26.10756202316284, 27.589999451637265, 26.27856180858612, 24.934124499320983, 25.539562047004694, 30.390686951637274, 28.071999308586122, 27.094561808586118, 24.792124547004704, 27.569999380111692, 24.044562047004696, 23.57212469005585, 30.03699902248383, 23.957687094688414, 25.298999594688418, 27.219999332427978, 24.086124666213987, 24.643999499320984, 30.162561880111692, 27.521999356269834, 30.297124237060547, 26.7829993801117, 27.888999380111695, 25.993561999320978, 25.35056202316284, 26.673999427795408, 29.084999403953546, 24.791124570846556, 27.023561927795413, 23.655124570846553, 26.9435617609024, 25.904999618530272, 26.750561927795406, 30.46312416553497, 29.063999380111696, 25.808562118530276, 24.612562190055847, 27.02656199932099, 27.288124427795413, 25.66512449932099, 22.710999618530273, 26.59856195163727, 26.92956190395355, 24.24612464237213, 28.286562023162837, 24.67112452316284, 25.618999523162838, 26.1345620470047, 28.254999189376836, 28.103124403953558, 31.15956157016754, 27.707124403953554, 27.495999356269834, 24.11512469005585, 27.287124308586115, 27.85399935626983, 29.18456192779541, 26.0495620470047, 29.160561689376834, 27.375124570846555, 26.1531245470047, 25.056687094688417, 27.862561951637268, 26.0575620470047, 27.137124356269833, 27.117124356269834, 29.560687070846555, 26.444124713897708, 30.7105617609024, 26.83456183242798, 30.47812435626983, 25.903561927795415, 26.340124475479126, 25.129124475479124, 27.107124547004698, 30.567124213218694, 25.82656192779541, 25.824124618530274, 28.389124642372135, 27.509999570846556, 24.707124618530273, 27.8289995470047, 25.435124475479128, 29.344999356269838, 26.892124499320982, 24.955999618530274, 28.24056173706055, 26.82156180858612, 30.17799918937683, 25.004124427795407, 29.438124284744266, 25.66812464237213, 25.46268714237213, 26.472124475479124, 26.69612440395355, 26.588561832427974, 26.94856192779541, 27.261561975479122, 27.78412428474426, 28.577561760902405, 26.559124332427977, 29.659999141693113, 28.89456185626984, 28.583561927795408, 27.765124451637266, 26.4059993801117, 28.584562023162842, 26.169124547004696, 28.559562023162837, 26.0806870470047, 26.62399938011169, 29.765999332427977, 28.878561856269837, 28.817561784744257, 29.72756168937683, 28.89156192779541, 26.99212442779541, 27.469561975479124, 29.278999237060546, 24.586124451637268, 24.292999594688418], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4638225350096272, "mean_inference_ms": 1.1913208261447594, "mean_action_processing_ms": 0.13224666584652475, "mean_env_wait_ms": 0.076668279565507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041321849822998045, "StateBufferConnector_ms": 0.056528759002685544, "ViewRequirementAgentConnector_ms": 0.37384710311889646}}, "episode_reward_max": 31.15956157016754, "episode_reward_min": 20.52256219005585, "episode_reward_mean": 26.22511624169159, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.898999523162843, 23.669562070846556, 28.807561737060546, 26.338999308586125, 26.381124475479126, 26.998999499320984, 27.131687166213993, 24.353999594688414, 24.054562047004698, 24.023124594688422, 24.126124833106996, 24.8799995470047, 24.324562094688417, 21.497562190055845, 23.366999594688416, 26.545999594688418, 28.148999427795417, 28.480686975479127, 25.63912459468841, 24.076124547004703, 25.878999499320987, 25.61912442779541, 26.99212430858612, 25.591561880111687, 25.52656202316284, 24.85856211853027, 24.99256211853027, 27.23512459468842, 26.063561975479125, 22.115124618530274, 24.446562094688414, 25.778999475479132, 24.715562070846552, 26.360999451637266, 25.462561784744263, 25.728999499320985, 28.28856207084656, 24.7445620470047, 24.521562023162844, 26.338999594688417, 23.602999618530273, 23.028124642372134, 25.33112459468841, 25.315999499320984, 26.272562023162845, 25.951562047004696, 27.622999475479123, 24.686562118530283, 26.781561808586122, 25.56256202316284, 27.27756197547913, 26.264124403953552, 24.64556226158142, 24.887561951637267, 22.16768699932098, 28.61268680858612, 25.62556219005585, 25.219999666213987, 26.992561880111694, 24.533999523162848, 24.61512461853027, 26.09456211853027, 22.71756226158142, 26.130999618530275, 25.24256195163727, 26.02812442779541, 24.86756216621399, 26.75399949932099, 27.482561832427983, 23.79556207084656, 29.220561856269832, 26.128999499320983, 27.789561999320988, 25.804561880111695, 26.15799952316284, 26.82812445163727, 24.58056207084656, 23.28612461853027, 26.208562070846558, 27.78356195163727, 26.028124570846554, 29.05012433242798, 24.615999570846554, 24.632562070846557, 25.788561999320983, 24.027124833106992, 24.68656219005584, 27.177999499320986, 20.52256219005585, 22.820999403953554, 25.15156192779541, 25.30412447547912, 25.665562190055844, 26.906124570846558, 22.3565622138977, 23.749562118530278, 22.97956226158142, 26.50199945163726, 25.741562070846562, 24.862562285423277, 26.254999547004697, 23.951562094688413, 24.146124618530273, 22.995999618530274, 25.18456188011169, 26.77556199932098, 27.88756192779541, 25.00256219005584, 21.359562333106993, 26.885686951637275, 25.88912457084655, 24.744124523162842, 25.654999475479126, 25.922999618530277, 24.412562023162838, 27.91012442779541, 26.244124475479122, 25.37099952316284, 25.78056211853027, 22.8565620470047, 26.076124547004696, 24.451562142372126, 26.19168697547913, 21.509562118530276, 28.430999332427977, 25.05312466621399, 27.01656197547912, 25.302124618530275, 24.711562118530274, 26.10756202316284, 27.589999451637265, 26.27856180858612, 24.934124499320983, 25.539562047004694, 30.390686951637274, 28.071999308586122, 27.094561808586118, 24.792124547004704, 27.569999380111692, 24.044562047004696, 23.57212469005585, 30.03699902248383, 23.957687094688414, 25.298999594688418, 27.219999332427978, 24.086124666213987, 24.643999499320984, 30.162561880111692, 27.521999356269834, 30.297124237060547, 26.7829993801117, 27.888999380111695, 25.993561999320978, 25.35056202316284, 26.673999427795408, 29.084999403953546, 24.791124570846556, 27.023561927795413, 23.655124570846553, 26.9435617609024, 25.904999618530272, 26.750561927795406, 30.46312416553497, 29.063999380111696, 25.808562118530276, 24.612562190055847, 27.02656199932099, 27.288124427795413, 25.66512449932099, 22.710999618530273, 26.59856195163727, 26.92956190395355, 24.24612464237213, 28.286562023162837, 24.67112452316284, 25.618999523162838, 26.1345620470047, 28.254999189376836, 28.103124403953558, 31.15956157016754, 27.707124403953554, 27.495999356269834, 24.11512469005585, 27.287124308586115, 27.85399935626983, 29.18456192779541, 26.0495620470047, 29.160561689376834, 27.375124570846555, 26.1531245470047, 25.056687094688417, 27.862561951637268, 26.0575620470047, 27.137124356269833, 27.117124356269834, 29.560687070846555, 26.444124713897708, 30.7105617609024, 26.83456183242798, 30.47812435626983, 25.903561927795415, 26.340124475479126, 25.129124475479124, 27.107124547004698, 30.567124213218694, 25.82656192779541, 25.824124618530274, 28.389124642372135, 27.509999570846556, 24.707124618530273, 27.8289995470047, 25.435124475479128, 29.344999356269838, 26.892124499320982, 24.955999618530274, 28.24056173706055, 26.82156180858612, 30.17799918937683, 25.004124427795407, 29.438124284744266, 25.66812464237213, 25.46268714237213, 26.472124475479124, 26.69612440395355, 26.588561832427974, 26.94856192779541, 27.261561975479122, 27.78412428474426, 28.577561760902405, 26.559124332427977, 29.659999141693113, 28.89456185626984, 28.583561927795408, 27.765124451637266, 26.4059993801117, 28.584562023162842, 26.169124547004696, 28.559562023162837, 26.0806870470047, 26.62399938011169, 29.765999332427977, 28.878561856269837, 28.817561784744257, 29.72756168937683, 28.89156192779541, 26.99212442779541, 27.469561975479124, 29.278999237060546, 24.586124451637268, 24.292999594688418], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4638225350096272, "mean_inference_ms": 1.1913208261447594, "mean_action_processing_ms": 0.13224666584652475, "mean_env_wait_ms": 0.076668279565507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041321849822998045, "StateBufferConnector_ms": 0.056528759002685544, "ViewRequirementAgentConnector_ms": 0.37384710311889646}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.7079058165065, "num_env_steps_trained_throughput_per_sec": 312.7079058165065, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11250.927, "sample_time_ms": 5782.092, "load_time_ms": 0.429, "load_throughput": 9331043.382, "learn_time_ms": 5465.177, "learn_throughput": 731.907, "synch_weights_time_ms": 2.337}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": true, "episodes_total": 720, "training_iteration": 3, "trial_id": "4f0c0_00000", "date": "2023-08-26_17-08-23", "timestamp": 1693062503, "time_this_iter_s": 12.805083274841309, "time_total_s": 33.79076099395752, "pid": 42822, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa912fb04c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 33.79076099395752, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 68.4, "ram_util_percent": 87.0736842105263}}
