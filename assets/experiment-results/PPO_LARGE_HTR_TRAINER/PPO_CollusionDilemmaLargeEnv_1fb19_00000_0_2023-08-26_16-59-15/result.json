{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.711581807575559, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.48677683197042, "policy_loss": -0.00626719827933978, "vf_loss": 1.4912588472488106, "vf_explained_var": -0.0018985886727609941, "kl": 0.00892590455780831, "entropy": 0.6842694243436218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 400.2449914169314, "episode_reward_min": 17.409999833106998, "episode_reward_mean": 26.78960403307135, "episode_len_mean": 18.181818181818183, "episode_media": {}, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.2449914169314, 26.999999427795412, 26.28399938011169, 24.94199928474426, 27.690999356269835, 23.49399947547913, 24.436999499320983, 26.100999332427982, 23.007999690055843, 23.394999547004698, 22.524999475479124, 24.843999475479126, 21.388999666213987, 23.580999618530274, 22.817999523162843, 25.101999356269836, 24.957999451637267, 23.339999499320985, 23.723999427795412, 26.47599933242798, 26.7409994277954, 25.50599957084656, 26.21699938011169, 24.95099942779541, 24.291999380111694, 26.072999475479126, 25.652999332427978, 23.548999547004698, 23.17599966621399, 26.348999451637273, 25.73099935626984, 25.250999547004707, 26.159999380111692, 26.762999427795407, 24.708999237060546, 26.20999961853027, 25.992999451637264, 24.3489995470047, 24.900999284744262, 28.01499923706055, 22.67499966621399, 26.19299952316284, 26.535999332427977, 22.94199964237213, 25.538999427795414, 28.631999380111697, 23.03299945163727, 25.55699952316284, 23.060999547004702, 25.06399940395355, 27.079999284744268, 24.00999952316284, 22.82099959468841, 25.354999260902407, 27.810999094009397, 25.761999570846566, 24.88899952316284, 20.944999833106998, 23.819999594688415, 27.537999332427983, 26.404999427795406, 25.147999570846554, 23.459999380111697, 26.717999380111696, 24.160999403953557, 26.397999451637265, 25.197999356269833, 23.140999332427977, 23.42899930858612, 27.938999475479132, 23.964999547004698, 24.63599949932098, 25.490999403953552, 21.452999594688414, 23.807999403953556, 23.70099945163727, 21.339999690055848, 27.744999070167545, 25.595999308586116, 20.696999713897704, 26.20099945163727, 25.290999547004695, 24.305999451637263, 24.87299957084656, 27.331999403953553, 25.48599942779541, 23.3329995470047, 26.73099949932099, 24.824999547004698, 23.72599947547913, 25.910999523162843, 29.055999356269837, 25.04299947547912, 27.141999284744262, 24.17299942779541, 24.324999499320988, 23.162999642372135, 26.656999356269836, 23.39899957084656, 28.000999284744257, 24.706999380111696, 27.447999380111693, 27.80899940395355, 24.927999260902403, 25.042999451637268, 25.907999547004703, 27.62199942779541, 24.618999499320985, 25.882999403953555, 24.489999427795407, 354.26399470710743, 20.043999713897705, 20.951999642372133, 24.14499952316285, 24.577999547004698, 22.716999666213987, 24.18999945163727, 22.516999809265137, 21.79899964237213, 23.999999761581417, 21.623999594688414, 23.53799942779541, 21.07199964237213, 19.292999809265137, 23.510999690055844, 22.29299961853027, 21.90999957084656, 21.909999642372128, 23.62299957084656, 22.053999570846553, 20.764999642372132, 22.68199947547913, 22.500999547004696, 20.30399964237213, 22.111999761581423, 23.94199952316284, 22.19799976158142, 24.191999642372135, 20.719999594688417, 21.695999594688413, 23.281999570846555, 20.37099978542328, 23.471999427795417, 21.422999594688413, 25.4409995470047, 22.51299959468842, 17.802999785423278, 23.071999713897707, 24.45999966621399, 17.409999833106998, 22.98999945163727, 23.988999547004703, 22.64699973773956, 20.376999737739563, 23.001999570846557, 23.847999451637268, 21.043999618530272, 24.600999499320984, 21.378999690055853, 23.709999523162843, 20.740999666213984, 21.01699978542328, 21.205999690055847, 22.6199995470047, 20.850999475479128, 20.855999785423275, 23.711999570846558, 19.871999809265134, 20.40599976158142, 21.562999618530277, 24.16699964237213, 21.242999737739563, 21.654999666213993, 25.169999403953558, 21.631999594688416, 19.027999856948853, 22.895999570846556, 23.44699957084656, 23.02899964237213, 24.190999523162844, 21.88299959468841, 23.708999713897704, 23.611999547004697, 21.291999642372133, 21.204999785423276, 17.541999880790712, 22.284999642372128, 18.969999642372134, 21.938999570846555, 22.36499978542328, 20.062999642372127, 22.99499959468842, 21.300999737739566, 21.693999713897703, 28.50999949932099, 22.773999475479123, 21.638999547004705, 21.27999973773956, 23.260999594688414, 22.332999642372133, 23.224999451637267, 23.200999713897705, 22.229999618530275, 22.433999642372132, 18.811999833106995, 21.88699976158142, 20.358999809265132, 20.985999642372132, 18.09399978542328, 20.825999642372132, 21.50099966621399, 20.63199966621399, 23.41299957084656, 22.436999618530276, 23.121999880790707, 22.263999618530267, 20.65399973773956, 21.886999594688415, 22.621999499320985, 22.12699969005585], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9513310585422312, "mean_inference_ms": 0.8127474296337244, "mean_action_processing_ms": 0.09311276158948116, "mean_env_wait_ms": 0.05386240300031257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024365728551691227, "StateBufferConnector_ms": 0.03180915659124201, "ViewRequirementAgentConnector_ms": 0.22337079048156738}}, "episode_reward_max": 400.2449914169314, "episode_reward_min": 17.409999833106998, "episode_reward_mean": 26.78960403307135, "episode_len_mean": 18.181818181818183, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [400.2449914169314, 26.999999427795412, 26.28399938011169, 24.94199928474426, 27.690999356269835, 23.49399947547913, 24.436999499320983, 26.100999332427982, 23.007999690055843, 23.394999547004698, 22.524999475479124, 24.843999475479126, 21.388999666213987, 23.580999618530274, 22.817999523162843, 25.101999356269836, 24.957999451637267, 23.339999499320985, 23.723999427795412, 26.47599933242798, 26.7409994277954, 25.50599957084656, 26.21699938011169, 24.95099942779541, 24.291999380111694, 26.072999475479126, 25.652999332427978, 23.548999547004698, 23.17599966621399, 26.348999451637273, 25.73099935626984, 25.250999547004707, 26.159999380111692, 26.762999427795407, 24.708999237060546, 26.20999961853027, 25.992999451637264, 24.3489995470047, 24.900999284744262, 28.01499923706055, 22.67499966621399, 26.19299952316284, 26.535999332427977, 22.94199964237213, 25.538999427795414, 28.631999380111697, 23.03299945163727, 25.55699952316284, 23.060999547004702, 25.06399940395355, 27.079999284744268, 24.00999952316284, 22.82099959468841, 25.354999260902407, 27.810999094009397, 25.761999570846566, 24.88899952316284, 20.944999833106998, 23.819999594688415, 27.537999332427983, 26.404999427795406, 25.147999570846554, 23.459999380111697, 26.717999380111696, 24.160999403953557, 26.397999451637265, 25.197999356269833, 23.140999332427977, 23.42899930858612, 27.938999475479132, 23.964999547004698, 24.63599949932098, 25.490999403953552, 21.452999594688414, 23.807999403953556, 23.70099945163727, 21.339999690055848, 27.744999070167545, 25.595999308586116, 20.696999713897704, 26.20099945163727, 25.290999547004695, 24.305999451637263, 24.87299957084656, 27.331999403953553, 25.48599942779541, 23.3329995470047, 26.73099949932099, 24.824999547004698, 23.72599947547913, 25.910999523162843, 29.055999356269837, 25.04299947547912, 27.141999284744262, 24.17299942779541, 24.324999499320988, 23.162999642372135, 26.656999356269836, 23.39899957084656, 28.000999284744257, 24.706999380111696, 27.447999380111693, 27.80899940395355, 24.927999260902403, 25.042999451637268, 25.907999547004703, 27.62199942779541, 24.618999499320985, 25.882999403953555, 24.489999427795407, 354.26399470710743, 20.043999713897705, 20.951999642372133, 24.14499952316285, 24.577999547004698, 22.716999666213987, 24.18999945163727, 22.516999809265137, 21.79899964237213, 23.999999761581417, 21.623999594688414, 23.53799942779541, 21.07199964237213, 19.292999809265137, 23.510999690055844, 22.29299961853027, 21.90999957084656, 21.909999642372128, 23.62299957084656, 22.053999570846553, 20.764999642372132, 22.68199947547913, 22.500999547004696, 20.30399964237213, 22.111999761581423, 23.94199952316284, 22.19799976158142, 24.191999642372135, 20.719999594688417, 21.695999594688413, 23.281999570846555, 20.37099978542328, 23.471999427795417, 21.422999594688413, 25.4409995470047, 22.51299959468842, 17.802999785423278, 23.071999713897707, 24.45999966621399, 17.409999833106998, 22.98999945163727, 23.988999547004703, 22.64699973773956, 20.376999737739563, 23.001999570846557, 23.847999451637268, 21.043999618530272, 24.600999499320984, 21.378999690055853, 23.709999523162843, 20.740999666213984, 21.01699978542328, 21.205999690055847, 22.6199995470047, 20.850999475479128, 20.855999785423275, 23.711999570846558, 19.871999809265134, 20.40599976158142, 21.562999618530277, 24.16699964237213, 21.242999737739563, 21.654999666213993, 25.169999403953558, 21.631999594688416, 19.027999856948853, 22.895999570846556, 23.44699957084656, 23.02899964237213, 24.190999523162844, 21.88299959468841, 23.708999713897704, 23.611999547004697, 21.291999642372133, 21.204999785423276, 17.541999880790712, 22.284999642372128, 18.969999642372134, 21.938999570846555, 22.36499978542328, 20.062999642372127, 22.99499959468842, 21.300999737739566, 21.693999713897703, 28.50999949932099, 22.773999475479123, 21.638999547004705, 21.27999973773956, 23.260999594688414, 22.332999642372133, 23.224999451637267, 23.200999713897705, 22.229999618530275, 22.433999642372132, 18.811999833106995, 21.88699976158142, 20.358999809265132, 20.985999642372132, 18.09399978542328, 20.825999642372132, 21.50099966621399, 20.63199966621399, 23.41299957084656, 22.436999618530276, 23.121999880790707, 22.263999618530267, 20.65399973773956, 21.886999594688415, 22.621999499320985, 22.12699969005585], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9513310585422312, "mean_inference_ms": 0.8127474296337244, "mean_action_processing_ms": 0.09311276158948116, "mean_env_wait_ms": 0.05386240300031257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024365728551691227, "StateBufferConnector_ms": 0.03180915659124201, "ViewRequirementAgentConnector_ms": 0.22337079048156738}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 472.96481437420147, "num_env_steps_trained_throughput_per_sec": 472.96481437420147, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8457.242, "sample_time_ms": 3876.191, "load_time_ms": 0.423, "load_throughput": 9457280.722, "learn_time_ms": 4577.886, "learn_throughput": 873.766, "synch_weights_time_ms": 2.067}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 220, "training_iteration": 1, "trial_id": "1fb19_00000", "date": "2023-08-26_16-59-28", "timestamp": 1693061968, "time_this_iter_s": 8.468662977218628, "time_total_s": 8.468662977218628, "pid": 36873, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f953031d4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8.468662977218628, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.04615384615385, "ram_util_percent": 83.50769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.832408650491827, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2666821474880381, "policy_loss": -0.02220091279395806, "vf_loss": 0.2819612041596443, "vf_explained_var": 0.0, "kl": 0.034609289423272176, "entropy": 0.6179980188928624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 29.24599933242798, "episode_reward_min": 17.753999713897706, "episode_reward_mean": 23.561639547576902, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.596999570846556, 25.604999427795413, 29.24599933242798, 24.89799942779541, 25.043999499320986, 23.374999594688415, 26.721999308586117, 26.528999427795412, 23.737999523162838, 23.71299942779541, 25.561999499320983, 23.937999570846557, 25.687999427795408, 22.388999690055847, 26.85999940395355, 26.414999332427982, 24.43899933242798, 21.53599966621399, 24.094999380111695, 25.25499945163726, 24.192999451637267, 23.267999618530272, 28.009999213218688, 25.994999427795406, 28.03299928474426, 22.754999713897707, 24.332999499320987, 25.961999403953556, 25.69899945163727, 24.748999356269838, 24.588999523162837, 24.57499940395355, 24.818999451637268, 24.520999570846563, 24.538999427795407, 26.017999356269833, 25.484999547004698, 25.32499928474426, 25.677999356269833, 25.13299945163727, 24.683999356269837, 24.28899949932099, 24.515999451637267, 25.69699947547913, 25.889999380111696, 24.165999380111693, 23.58699952316284, 22.610999594688423, 27.706999260902403, 27.50199921321869, 26.42499938011169, 25.73899918937683, 23.85099949932098, 26.96399928474426, 24.48399949932098, 28.186999427795406, 25.12299942779541, 25.60499935626984, 26.341999499320984, 25.927999356269837, 22.690999642372134, 24.2969993801117, 25.091999380111687, 23.7129995470047, 24.228999594688414, 24.429999570846554, 25.468999380111697, 25.238999618530276, 25.771999380111694, 25.34999940395355, 24.535999570846553, 24.593999547004696, 27.157999213218687, 26.342999308586123, 23.55899938011169, 27.066999403953552, 23.110999642372132, 27.365999189376836, 24.59999935626984, 24.673999308586126, 23.26999949932098, 26.00699952316284, 21.484999594688414, 22.10099976158142, 25.62699916553497, 26.56099947547912, 24.788999380111697, 23.6849995470047, 25.164999451637268, 24.190999427795408, 23.131999332427977, 25.768999713897703, 24.600999427795408, 28.607999260902407, 25.212999451637266, 27.076999284744264, 25.703999427795416, 27.51499930858612, 25.262999451637267, 22.56999942779541, 27.01699933242798, 26.26599938011169, 27.52599923706055, 28.481999260902413, 26.344999380111695, 25.475999475479128, 26.201999451637274, 24.80899935626984, 24.476999380111696, 24.895999499320983, 25.560999356269832, 23.665999547004702, 23.010999713897704, 25.434999547004697, 25.84799938011169, 23.523999618530272, 24.98799947547912, 24.926999284744262, 25.67299940395355, 27.477999403953557, 24.60599930858612, 25.42599942779541, 26.42199945163727, 28.199999332427986, 25.050999523162844, 18.45799966621399, 21.029999690055842, 23.28699976158142, 20.891999690055847, 19.85699976158142, 22.690999594688414, 24.68799942779541, 22.491999690055845, 21.046999713897705, 20.301999833106997, 19.218999785423282, 20.247999690055845, 20.89399957084656, 24.128999475479127, 19.893999713897706, 21.141999690055844, 22.301999785423277, 24.205999499320985, 24.20899945163727, 19.98199976158142, 20.16799980926514, 20.582999666213986, 21.763999594688414, 21.366999618530276, 21.430999737739562, 21.611999737739563, 22.99599945163727, 23.032999570846556, 20.822999642372128, 20.638999833106993, 21.278999618530275, 22.38999973773956, 21.986999523162844, 24.318999451637264, 20.87199988079071, 22.5389995470047, 22.416999594688413, 24.64899947547913, 22.775999642372135, 21.367999809265136, 20.524999618530273, 22.447999809265134, 22.263999833106997, 22.913999523162843, 22.90299964237213, 23.957999570846564, 24.161999451637264, 21.25099969005585, 21.580999713897707, 23.45699961853027, 22.04999969005585, 21.815999642372127, 21.925999713897706, 22.547999594688417, 20.023999666213992, 22.7059995470047, 22.177999690055845, 22.131999523162843, 21.158999690055843, 23.861999403953554, 23.09699964237213, 21.17999988079071, 24.651999547004703, 22.947999547004702, 20.92699976158142, 23.166999523162843, 22.34499969005585, 21.431999880790713, 23.23099964237213, 21.629999618530274, 23.161999642372134, 21.805999594688416, 21.415999666213988, 21.465999618530272, 21.607999833106998, 22.29099973773956, 21.129999809265136, 20.618999785423277, 20.499999928474427, 20.846999761581426, 21.843999594688416, 21.769999570846558, 22.106999690055844, 23.599999737739562, 21.912999713897708, 20.87399976158142, 24.274999618530273, 22.456999761581425, 21.934999713897703, 22.890999570846553, 20.014999690055845, 22.053999570846557, 21.325999666213985, 20.46199969005585, 24.400999451637265, 24.45999957084656, 22.715999618530272, 24.084999451637266, 22.754999666213983, 23.292999499320985, 21.71699964237213, 23.867999570846557, 22.068999523162837, 20.61599976158142, 21.30799969005585, 22.096999570846553, 23.908999713897703, 21.650999713897704, 19.785999713897702, 22.77399959468842, 21.105999713897706, 20.846999761581426, 20.566999737739565, 21.057999642372135, 17.753999713897706, 21.087999761581422, 20.49299966621399, 21.674999785423275, 19.714999761581417, 22.0669997138977, 21.15099983310699, 19.52699976158142, 22.557999594688415, 22.560999499320985, 22.360999499320986], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0438903037740777, "mean_inference_ms": 0.8771554793872943, "mean_action_processing_ms": 0.0978334937444838, "mean_env_wait_ms": 0.057814211226856364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026555633544921874, "StateBufferConnector_ms": 0.03534784317016602, "ViewRequirementAgentConnector_ms": 0.24106855392456056}}, "episode_reward_max": 29.24599933242798, "episode_reward_min": 17.753999713897706, "episode_reward_mean": 23.561639547576902, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.596999570846556, 25.604999427795413, 29.24599933242798, 24.89799942779541, 25.043999499320986, 23.374999594688415, 26.721999308586117, 26.528999427795412, 23.737999523162838, 23.71299942779541, 25.561999499320983, 23.937999570846557, 25.687999427795408, 22.388999690055847, 26.85999940395355, 26.414999332427982, 24.43899933242798, 21.53599966621399, 24.094999380111695, 25.25499945163726, 24.192999451637267, 23.267999618530272, 28.009999213218688, 25.994999427795406, 28.03299928474426, 22.754999713897707, 24.332999499320987, 25.961999403953556, 25.69899945163727, 24.748999356269838, 24.588999523162837, 24.57499940395355, 24.818999451637268, 24.520999570846563, 24.538999427795407, 26.017999356269833, 25.484999547004698, 25.32499928474426, 25.677999356269833, 25.13299945163727, 24.683999356269837, 24.28899949932099, 24.515999451637267, 25.69699947547913, 25.889999380111696, 24.165999380111693, 23.58699952316284, 22.610999594688423, 27.706999260902403, 27.50199921321869, 26.42499938011169, 25.73899918937683, 23.85099949932098, 26.96399928474426, 24.48399949932098, 28.186999427795406, 25.12299942779541, 25.60499935626984, 26.341999499320984, 25.927999356269837, 22.690999642372134, 24.2969993801117, 25.091999380111687, 23.7129995470047, 24.228999594688414, 24.429999570846554, 25.468999380111697, 25.238999618530276, 25.771999380111694, 25.34999940395355, 24.535999570846553, 24.593999547004696, 27.157999213218687, 26.342999308586123, 23.55899938011169, 27.066999403953552, 23.110999642372132, 27.365999189376836, 24.59999935626984, 24.673999308586126, 23.26999949932098, 26.00699952316284, 21.484999594688414, 22.10099976158142, 25.62699916553497, 26.56099947547912, 24.788999380111697, 23.6849995470047, 25.164999451637268, 24.190999427795408, 23.131999332427977, 25.768999713897703, 24.600999427795408, 28.607999260902407, 25.212999451637266, 27.076999284744264, 25.703999427795416, 27.51499930858612, 25.262999451637267, 22.56999942779541, 27.01699933242798, 26.26599938011169, 27.52599923706055, 28.481999260902413, 26.344999380111695, 25.475999475479128, 26.201999451637274, 24.80899935626984, 24.476999380111696, 24.895999499320983, 25.560999356269832, 23.665999547004702, 23.010999713897704, 25.434999547004697, 25.84799938011169, 23.523999618530272, 24.98799947547912, 24.926999284744262, 25.67299940395355, 27.477999403953557, 24.60599930858612, 25.42599942779541, 26.42199945163727, 28.199999332427986, 25.050999523162844, 18.45799966621399, 21.029999690055842, 23.28699976158142, 20.891999690055847, 19.85699976158142, 22.690999594688414, 24.68799942779541, 22.491999690055845, 21.046999713897705, 20.301999833106997, 19.218999785423282, 20.247999690055845, 20.89399957084656, 24.128999475479127, 19.893999713897706, 21.141999690055844, 22.301999785423277, 24.205999499320985, 24.20899945163727, 19.98199976158142, 20.16799980926514, 20.582999666213986, 21.763999594688414, 21.366999618530276, 21.430999737739562, 21.611999737739563, 22.99599945163727, 23.032999570846556, 20.822999642372128, 20.638999833106993, 21.278999618530275, 22.38999973773956, 21.986999523162844, 24.318999451637264, 20.87199988079071, 22.5389995470047, 22.416999594688413, 24.64899947547913, 22.775999642372135, 21.367999809265136, 20.524999618530273, 22.447999809265134, 22.263999833106997, 22.913999523162843, 22.90299964237213, 23.957999570846564, 24.161999451637264, 21.25099969005585, 21.580999713897707, 23.45699961853027, 22.04999969005585, 21.815999642372127, 21.925999713897706, 22.547999594688417, 20.023999666213992, 22.7059995470047, 22.177999690055845, 22.131999523162843, 21.158999690055843, 23.861999403953554, 23.09699964237213, 21.17999988079071, 24.651999547004703, 22.947999547004702, 20.92699976158142, 23.166999523162843, 22.34499969005585, 21.431999880790713, 23.23099964237213, 21.629999618530274, 23.161999642372134, 21.805999594688416, 21.415999666213988, 21.465999618530272, 21.607999833106998, 22.29099973773956, 21.129999809265136, 20.618999785423277, 20.499999928474427, 20.846999761581426, 21.843999594688416, 21.769999570846558, 22.106999690055844, 23.599999737739562, 21.912999713897708, 20.87399976158142, 24.274999618530273, 22.456999761581425, 21.934999713897703, 22.890999570846553, 20.014999690055845, 22.053999570846557, 21.325999666213985, 20.46199969005585, 24.400999451637265, 24.45999957084656, 22.715999618530272, 24.084999451637266, 22.754999666213983, 23.292999499320985, 21.71699964237213, 23.867999570846557, 22.068999523162837, 20.61599976158142, 21.30799969005585, 22.096999570846553, 23.908999713897703, 21.650999713897704, 19.785999713897702, 22.77399959468842, 21.105999713897706, 20.846999761581426, 20.566999737739565, 21.057999642372135, 17.753999713897706, 21.087999761581422, 20.49299966621399, 21.674999785423275, 19.714999761581417, 22.0669997138977, 21.15099983310699, 19.52699976158142, 22.557999594688415, 22.560999499320985, 22.360999499320986], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0438903037740777, "mean_inference_ms": 0.8771554793872943, "mean_action_processing_ms": 0.0978334937444838, "mean_env_wait_ms": 0.057814211226856364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026555633544921874, "StateBufferConnector_ms": 0.03534784317016602, "ViewRequirementAgentConnector_ms": 0.24106855392456056}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.2669355738053, "num_env_steps_trained_throughput_per_sec": 441.2669355738053, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8761.014, "sample_time_ms": 4212.842, "load_time_ms": 0.454, "load_throughput": 8804626.607, "learn_time_ms": 4544.976, "learn_throughput": 880.093, "synch_weights_time_ms": 2.032}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 470, "training_iteration": 2, "trial_id": "1fb19_00000", "date": "2023-08-26_16-59-37", "timestamp": 1693061977, "time_this_iter_s": 9.07900357246399, "time_total_s": 17.547666549682617, "pid": 36873, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f953031d4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 17.547666549682617, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.26923076923077, "ram_util_percent": 83.65384615384613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.512085707405562, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23810642972658638, "policy_loss": -0.0639226685107876, "vf_loss": 0.29615458604148637, "vf_explained_var": 0.0, "kl": 0.019581705898162643, "entropy": 0.6749121962695993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 28.664999165534976, "episode_reward_min": 19.123999856948853, "episode_reward_mean": 24.08379553117371, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.208999380111692, 26.54399942779541, 27.018999284744265, 27.43099933242798, 23.85699942779541, 25.961999332427975, 24.781999475479125, 25.645999427795413, 25.93299928474426, 24.044999499320983, 24.825999332427983, 25.870999356269834, 26.909999356269836, 25.05299952316284, 26.37899940395355, 25.764999403953546, 26.566999260902403, 24.795999475479128, 27.920999284744262, 26.962999332427984, 25.711999547004705, 27.259999332427974, 26.514999451637266, 24.8029995470047, 25.24199942779541, 26.061999451637266, 26.252999260902403, 26.479999380111696, 26.350999403953555, 25.880999356269836, 26.4529993801117, 27.153999284744266, 26.19099940395355, 25.38899933242798, 23.085999570846557, 26.782999380111697, 25.955999356269842, 24.77199947547913, 26.15399940395355, 23.16999921321869, 25.43099949932099, 25.985999380111693, 26.018999332427978, 25.924999356269836, 25.135999332427975, 26.230999332427977, 26.03699930858612, 24.331999380111696, 23.753999713897702, 24.859999523162845, 27.92299916553497, 24.675999499320984, 24.030999475479128, 25.080999403953548, 27.695999237060548, 23.7949995470047, 24.107999499320982, 24.19199949932098, 25.59399942779541, 26.328999451637273, 26.61499930858612, 26.183999403953546, 24.52499935626984, 25.68799930858612, 27.688999427795416, 22.575999523162842, 26.41299933242798, 24.137999380111687, 27.52199933242798, 24.877999403953552, 25.020999427795417, 26.404999427795406, 24.593999547004696, 28.625999237060547, 27.483999332427977, 25.8839995470047, 24.95599940395355, 27.024999308586125, 25.789999475479128, 24.446999594688414, 27.797999213218695, 26.38499940395355, 24.832999451637264, 25.48899945163727, 27.08499935626984, 26.525999499320985, 24.65399930858612, 24.7009995470047, 23.596999475479123, 26.698999356269837, 28.04299923706055, 25.34899945163727, 26.815999237060552, 24.51099942779541, 26.264999332427976, 24.834999403953553, 24.700999666213992, 28.071999213218685, 28.105999237060544, 27.31799930858612, 24.712999356269837, 25.681999403953554, 24.744999403953553, 26.837999380111693, 25.21599930858612, 26.258999403953553, 24.62499935626984, 26.672999380111694, 24.178999547004704, 26.024999332427978, 25.020999427795417, 25.059999475479124, 23.643999523162844, 23.87899969005585, 25.57399945163727, 24.40699933242798, 26.618999356269835, 28.664999165534976, 25.517999499320986, 26.03499940395355, 24.54499949932098, 24.681999547004697, 23.83799947547913, 22.53799957084656, 25.603999380111695, 23.657999499320987, 23.434999690055847, 21.543999809265138, 20.322999856948854, 25.075999594688415, 22.13399964237213, 22.340999737739562, 21.453999594688415, 22.701999594688417, 23.91199964237213, 21.161999737739563, 23.682999594688415, 22.3369995470047, 21.301999713897708, 23.922999761581423, 24.47999949932099, 25.168999523162842, 24.696999594688414, 22.164999713897707, 23.47099947547913, 23.130999809265134, 22.908999594688417, 23.966999594688414, 22.75399952316284, 22.493999547004698, 22.696999594688414, 20.222999856948853, 24.5109995470047, 23.055999690055845, 22.292999690055847, 21.704999761581423, 21.214999690055844, 22.652999499320984, 22.969999594688417, 23.505999618530275, 23.380999618530275, 23.339999570846555, 23.614999475479127, 21.88999973773956, 23.5079997138977, 24.360999594688415, 24.152999713897703, 24.34499961853027, 21.315999666213987, 20.703999785423274, 20.58699961853027, 23.326999690055846, 22.641999713897704, 23.701999594688417, 23.62399966621399, 23.14299964237213, 21.555999785423282, 22.155999642372127, 22.205999547004698, 22.97599964237213, 20.381999737739562, 22.892999666213985, 21.20599978542328, 22.13299969005585, 24.086999713897708, 22.768999713897703, 22.758999618530275, 23.09299976158142, 20.015999690055846, 23.40499957084656, 21.230999713897706, 22.50899961853027, 21.541999737739562, 22.393999618530273, 21.433999618530276, 19.638999833106993, 20.4669997138977, 20.990999713897708, 23.2799995470047, 22.997999713897702, 22.676999594688418, 22.88899966621399, 20.827999690055847, 22.971999642372133, 22.764999737739565, 26.60099942779542, 22.409999547004702, 19.71699976158142, 19.702999690055847, 23.96499957084656, 21.90099964237213, 19.123999856948853, 21.495999666213987, 20.240999856948854, 23.78999952316284, 25.70699933242798, 23.20799969005585, 22.414999618530278, 22.67099966621399, 23.505999618530275, 20.12599980926514, 22.797999785423276, 22.95999971389771, 21.03299973773956, 20.283999761581423, 22.495999713897703, 21.76599964237213, 24.247999594688412, 22.224999642372133, 23.748999570846557, 21.83999964237213, 20.414999761581424, 20.896999713897706, 23.80699966621399, 23.126999570846557, 20.11699976158142, 23.278999809265137, 22.256999690055846, 24.097999475479124, 23.89299959468842, 22.332999690055843, 23.01199964237213, 20.427999833107002, 21.461999666213988, 25.19299952316284, 21.73199978542328, 20.222999761581423, 24.13999971389771, 21.571999618530274, 22.931999594688417], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0907354205474316, "mean_inference_ms": 0.8841610177320911, "mean_action_processing_ms": 0.09935413911091928, "mean_env_wait_ms": 0.05970236023869679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026522254943847655, "StateBufferConnector_ms": 0.03582906723022461, "ViewRequirementAgentConnector_ms": 0.2407923698425293}}, "episode_reward_max": 28.664999165534976, "episode_reward_min": 19.123999856948853, "episode_reward_mean": 24.08379553117371, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.208999380111692, 26.54399942779541, 27.018999284744265, 27.43099933242798, 23.85699942779541, 25.961999332427975, 24.781999475479125, 25.645999427795413, 25.93299928474426, 24.044999499320983, 24.825999332427983, 25.870999356269834, 26.909999356269836, 25.05299952316284, 26.37899940395355, 25.764999403953546, 26.566999260902403, 24.795999475479128, 27.920999284744262, 26.962999332427984, 25.711999547004705, 27.259999332427974, 26.514999451637266, 24.8029995470047, 25.24199942779541, 26.061999451637266, 26.252999260902403, 26.479999380111696, 26.350999403953555, 25.880999356269836, 26.4529993801117, 27.153999284744266, 26.19099940395355, 25.38899933242798, 23.085999570846557, 26.782999380111697, 25.955999356269842, 24.77199947547913, 26.15399940395355, 23.16999921321869, 25.43099949932099, 25.985999380111693, 26.018999332427978, 25.924999356269836, 25.135999332427975, 26.230999332427977, 26.03699930858612, 24.331999380111696, 23.753999713897702, 24.859999523162845, 27.92299916553497, 24.675999499320984, 24.030999475479128, 25.080999403953548, 27.695999237060548, 23.7949995470047, 24.107999499320982, 24.19199949932098, 25.59399942779541, 26.328999451637273, 26.61499930858612, 26.183999403953546, 24.52499935626984, 25.68799930858612, 27.688999427795416, 22.575999523162842, 26.41299933242798, 24.137999380111687, 27.52199933242798, 24.877999403953552, 25.020999427795417, 26.404999427795406, 24.593999547004696, 28.625999237060547, 27.483999332427977, 25.8839995470047, 24.95599940395355, 27.024999308586125, 25.789999475479128, 24.446999594688414, 27.797999213218695, 26.38499940395355, 24.832999451637264, 25.48899945163727, 27.08499935626984, 26.525999499320985, 24.65399930858612, 24.7009995470047, 23.596999475479123, 26.698999356269837, 28.04299923706055, 25.34899945163727, 26.815999237060552, 24.51099942779541, 26.264999332427976, 24.834999403953553, 24.700999666213992, 28.071999213218685, 28.105999237060544, 27.31799930858612, 24.712999356269837, 25.681999403953554, 24.744999403953553, 26.837999380111693, 25.21599930858612, 26.258999403953553, 24.62499935626984, 26.672999380111694, 24.178999547004704, 26.024999332427978, 25.020999427795417, 25.059999475479124, 23.643999523162844, 23.87899969005585, 25.57399945163727, 24.40699933242798, 26.618999356269835, 28.664999165534976, 25.517999499320986, 26.03499940395355, 24.54499949932098, 24.681999547004697, 23.83799947547913, 22.53799957084656, 25.603999380111695, 23.657999499320987, 23.434999690055847, 21.543999809265138, 20.322999856948854, 25.075999594688415, 22.13399964237213, 22.340999737739562, 21.453999594688415, 22.701999594688417, 23.91199964237213, 21.161999737739563, 23.682999594688415, 22.3369995470047, 21.301999713897708, 23.922999761581423, 24.47999949932099, 25.168999523162842, 24.696999594688414, 22.164999713897707, 23.47099947547913, 23.130999809265134, 22.908999594688417, 23.966999594688414, 22.75399952316284, 22.493999547004698, 22.696999594688414, 20.222999856948853, 24.5109995470047, 23.055999690055845, 22.292999690055847, 21.704999761581423, 21.214999690055844, 22.652999499320984, 22.969999594688417, 23.505999618530275, 23.380999618530275, 23.339999570846555, 23.614999475479127, 21.88999973773956, 23.5079997138977, 24.360999594688415, 24.152999713897703, 24.34499961853027, 21.315999666213987, 20.703999785423274, 20.58699961853027, 23.326999690055846, 22.641999713897704, 23.701999594688417, 23.62399966621399, 23.14299964237213, 21.555999785423282, 22.155999642372127, 22.205999547004698, 22.97599964237213, 20.381999737739562, 22.892999666213985, 21.20599978542328, 22.13299969005585, 24.086999713897708, 22.768999713897703, 22.758999618530275, 23.09299976158142, 20.015999690055846, 23.40499957084656, 21.230999713897706, 22.50899961853027, 21.541999737739562, 22.393999618530273, 21.433999618530276, 19.638999833106993, 20.4669997138977, 20.990999713897708, 23.2799995470047, 22.997999713897702, 22.676999594688418, 22.88899966621399, 20.827999690055847, 22.971999642372133, 22.764999737739565, 26.60099942779542, 22.409999547004702, 19.71699976158142, 19.702999690055847, 23.96499957084656, 21.90099964237213, 19.123999856948853, 21.495999666213987, 20.240999856948854, 23.78999952316284, 25.70699933242798, 23.20799969005585, 22.414999618530278, 22.67099966621399, 23.505999618530275, 20.12599980926514, 22.797999785423276, 22.95999971389771, 21.03299973773956, 20.283999761581423, 22.495999713897703, 21.76599964237213, 24.247999594688412, 22.224999642372133, 23.748999570846557, 21.83999964237213, 20.414999761581424, 20.896999713897706, 23.80699966621399, 23.126999570846557, 20.11699976158142, 23.278999809265137, 22.256999690055846, 24.097999475479124, 23.89299959468842, 22.332999690055843, 23.01199964237213, 20.427999833107002, 21.461999666213988, 25.19299952316284, 21.73199978542328, 20.222999761581423, 24.13999971389771, 21.571999618530274, 22.931999594688417], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0907354205474316, "mean_inference_ms": 0.8841610177320911, "mean_action_processing_ms": 0.09935413911091928, "mean_env_wait_ms": 0.05970236023869679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026522254943847655, "StateBufferConnector_ms": 0.03582906723022461, "ViewRequirementAgentConnector_ms": 0.2407923698425293}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.335335017571, "num_env_steps_trained_throughput_per_sec": 437.335335017571, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8889.434, "sample_time_ms": 4317.306, "load_time_ms": 0.393, "load_throughput": 10186530.662, "learn_time_ms": 4569.055, "learn_throughput": 875.455, "synch_weights_time_ms": 1.993}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": true, "episodes_total": 720, "training_iteration": 3, "trial_id": "1fb19_00000", "date": "2023-08-26_16-59-46", "timestamp": 1693061986, "time_this_iter_s": 9.158565282821655, "time_total_s": 26.706231832504272, "pid": 36873, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f953031d4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 26.706231832504272, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.223076923076924, "ram_util_percent": 83.55384615384615}}
