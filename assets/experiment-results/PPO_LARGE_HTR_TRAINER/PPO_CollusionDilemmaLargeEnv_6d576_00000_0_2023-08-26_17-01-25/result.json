{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6802795047160757, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.519270048602935, "policy_loss": -0.005428685263920856, "vf_loss": 1.524241522371128, "vf_explained_var": -0.0002218921338358233, "kl": 0.002286030402245414, "entropy": 0.6910182297870677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 402.54999208450323, "episode_reward_min": 19.778999952316287, "episode_reward_mean": 27.877958516970548, "episode_len_mean": 18.181818181818183, "episode_media": {}, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [390.12999175071684, 25.435999380111696, 26.768999237060545, 25.611999356269838, 22.526999499320983, 24.986999403953554, 23.58099966621399, 22.41199959468841, 25.75999930858612, 21.20399949932098, 24.717999332427976, 27.13299933242798, 24.04099959468842, 27.20599933242798, 23.8039995470047, 21.634999594688413, 23.236999642372133, 23.323999618530273, 25.390999499320984, 24.115999642372127, 23.929999523162838, 23.54099961853028, 26.172999594688413, 23.549999594688416, 25.426999451637265, 26.829999475479127, 23.554999570846554, 25.96299945163727, 23.75999952316284, 23.32299969005585, 24.74099942779541, 25.569999547004702, 23.50999952316284, 23.37999964237213, 22.04399952316284, 27.37899940395355, 19.778999952316287, 26.270999380111693, 23.803999475479124, 24.510999427795415, 23.71999940395355, 23.930999523162843, 22.651999713897705, 25.931999475479124, 24.331999475479122, 24.900999547004698, 24.494999499320976, 25.571999427795408, 22.708999570846558, 26.079999451637267, 26.078999451637262, 24.442999499320983, 24.08299945163727, 24.572999475479122, 20.610999785423278, 21.38999961853027, 24.36299949932099, 27.14099938011169, 24.72599942779541, 24.941999356269832, 22.24499976158142, 22.152999642372134, 25.564999451637277, 22.465999737739562, 24.946999427795408, 25.83299933242798, 26.045999475479125, 23.84899942779541, 24.1639995470047, 24.873999237060545, 21.619999785423275, 21.242999618530277, 24.166999380111694, 23.78499959468841, 23.272999523162845, 28.065999356269838, 23.27599961853027, 26.001999356269835, 24.172999618530277, 23.614999547004697, 23.184999570846557, 23.114999690055846, 22.621999666213988, 22.33299964237213, 24.577999618530278, 22.366999785423275, 22.798999618530274, 20.3919995470047, 25.06599947547913, 24.77499940395355, 26.058999475479126, 23.155999451637268, 27.00599923706055, 25.54699954700471, 23.107999642372132, 25.303999499320987, 26.385999570846554, 23.20499959468841, 22.22599964237213, 23.359999618530274, 22.64499952316284, 24.899999475479127, 24.228999380111695, 23.025999642372135, 25.410999618530273, 24.109999403953548, 25.58199949932098, 22.368999570846558, 22.715999547004696, 21.6699995470047, 402.54999208450323, 25.73899935626983, 26.408999332427975, 26.37799938011169, 23.795999594688418, 25.09599964237213, 24.912999523162846, 26.764999475479126, 23.12699952316284, 23.71399942779541, 26.094999165534972, 26.16599930858612, 25.962999403953553, 25.41799918937683, 23.708999475479125, 24.07499940395356, 27.818999475479124, 27.6279992609024, 23.40399942779541, 23.2999995470047, 25.28199945163727, 24.943999403953555, 25.368999380111696, 24.534999499320982, 22.660999713897706, 23.21799976158142, 24.978999499320985, 22.966999570846554, 23.466999618530274, 24.934999570846557, 25.5319995470047, 25.69299945163727, 23.640999809265136, 25.852999594688416, 23.645999547004696, 27.667999308586126, 23.726999451637273, 26.200999332427976, 23.774999594688417, 22.677999499320986, 24.2499992609024, 25.174999356269836, 21.85799961853027, 25.455999547004698, 24.563999475479125, 24.521999475479124, 20.810999785423277, 26.235999451637262, 24.940999451637268, 23.999999713897704, 25.872999523162843, 26.57699935626983, 26.48399907016754, 25.202999380111695, 21.994999570846563, 26.637999308586117, 25.351999499320982, 25.047999570846557, 22.338999666213994, 25.637999499320987, 21.775999570846558, 24.953999332427976, 23.970999427795412, 24.654999642372125, 23.41499947547912, 27.787999189376826, 26.50699964237213, 27.503999332427977, 25.625999308586117, 25.481999451637268, 25.458999523162838, 25.967999332427976, 22.15799973773956, 24.727999427795414, 26.17699945163727, 25.943999403953548, 24.969999237060545, 21.854999547004695, 24.61299935626983, 26.28699930858612, 27.1139992609024, 22.972999523162837, 24.3939995470047, 21.288999737739562, 25.915999403953553, 25.62399942779541, 26.27399940395355, 26.329999332427985, 23.34099952316284, 23.003999666213986, 26.054999499320985, 24.495999427795418, 24.199999523162838, 27.81899942779541, 24.206999523162843, 25.766999380111685, 26.42299940395355, 27.528999141693117, 24.071999570846558, 23.425999618530277, 23.591999523162837, 23.13399957084656, 24.328999499320986, 24.717999594688415, 27.016999332427986, 25.580999427795412, 24.011999403953553, 24.76899947547913, 25.903999475479125, 22.861999594688413], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9567487960693419, "mean_inference_ms": 0.8500569585202514, "mean_action_processing_ms": 0.09760381221056343, "mean_env_wait_ms": 0.05546317941721889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601526000282981, "StateBufferConnector_ms": 0.03429976376620206, "ViewRequirementAgentConnector_ms": 0.2257624539462003}}, "episode_reward_max": 402.54999208450323, "episode_reward_min": 19.778999952316287, "episode_reward_mean": 27.877958516970548, "episode_len_mean": 18.181818181818183, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [390.12999175071684, 25.435999380111696, 26.768999237060545, 25.611999356269838, 22.526999499320983, 24.986999403953554, 23.58099966621399, 22.41199959468841, 25.75999930858612, 21.20399949932098, 24.717999332427976, 27.13299933242798, 24.04099959468842, 27.20599933242798, 23.8039995470047, 21.634999594688413, 23.236999642372133, 23.323999618530273, 25.390999499320984, 24.115999642372127, 23.929999523162838, 23.54099961853028, 26.172999594688413, 23.549999594688416, 25.426999451637265, 26.829999475479127, 23.554999570846554, 25.96299945163727, 23.75999952316284, 23.32299969005585, 24.74099942779541, 25.569999547004702, 23.50999952316284, 23.37999964237213, 22.04399952316284, 27.37899940395355, 19.778999952316287, 26.270999380111693, 23.803999475479124, 24.510999427795415, 23.71999940395355, 23.930999523162843, 22.651999713897705, 25.931999475479124, 24.331999475479122, 24.900999547004698, 24.494999499320976, 25.571999427795408, 22.708999570846558, 26.079999451637267, 26.078999451637262, 24.442999499320983, 24.08299945163727, 24.572999475479122, 20.610999785423278, 21.38999961853027, 24.36299949932099, 27.14099938011169, 24.72599942779541, 24.941999356269832, 22.24499976158142, 22.152999642372134, 25.564999451637277, 22.465999737739562, 24.946999427795408, 25.83299933242798, 26.045999475479125, 23.84899942779541, 24.1639995470047, 24.873999237060545, 21.619999785423275, 21.242999618530277, 24.166999380111694, 23.78499959468841, 23.272999523162845, 28.065999356269838, 23.27599961853027, 26.001999356269835, 24.172999618530277, 23.614999547004697, 23.184999570846557, 23.114999690055846, 22.621999666213988, 22.33299964237213, 24.577999618530278, 22.366999785423275, 22.798999618530274, 20.3919995470047, 25.06599947547913, 24.77499940395355, 26.058999475479126, 23.155999451637268, 27.00599923706055, 25.54699954700471, 23.107999642372132, 25.303999499320987, 26.385999570846554, 23.20499959468841, 22.22599964237213, 23.359999618530274, 22.64499952316284, 24.899999475479127, 24.228999380111695, 23.025999642372135, 25.410999618530273, 24.109999403953548, 25.58199949932098, 22.368999570846558, 22.715999547004696, 21.6699995470047, 402.54999208450323, 25.73899935626983, 26.408999332427975, 26.37799938011169, 23.795999594688418, 25.09599964237213, 24.912999523162846, 26.764999475479126, 23.12699952316284, 23.71399942779541, 26.094999165534972, 26.16599930858612, 25.962999403953553, 25.41799918937683, 23.708999475479125, 24.07499940395356, 27.818999475479124, 27.6279992609024, 23.40399942779541, 23.2999995470047, 25.28199945163727, 24.943999403953555, 25.368999380111696, 24.534999499320982, 22.660999713897706, 23.21799976158142, 24.978999499320985, 22.966999570846554, 23.466999618530274, 24.934999570846557, 25.5319995470047, 25.69299945163727, 23.640999809265136, 25.852999594688416, 23.645999547004696, 27.667999308586126, 23.726999451637273, 26.200999332427976, 23.774999594688417, 22.677999499320986, 24.2499992609024, 25.174999356269836, 21.85799961853027, 25.455999547004698, 24.563999475479125, 24.521999475479124, 20.810999785423277, 26.235999451637262, 24.940999451637268, 23.999999713897704, 25.872999523162843, 26.57699935626983, 26.48399907016754, 25.202999380111695, 21.994999570846563, 26.637999308586117, 25.351999499320982, 25.047999570846557, 22.338999666213994, 25.637999499320987, 21.775999570846558, 24.953999332427976, 23.970999427795412, 24.654999642372125, 23.41499947547912, 27.787999189376826, 26.50699964237213, 27.503999332427977, 25.625999308586117, 25.481999451637268, 25.458999523162838, 25.967999332427976, 22.15799973773956, 24.727999427795414, 26.17699945163727, 25.943999403953548, 24.969999237060545, 21.854999547004695, 24.61299935626983, 26.28699930858612, 27.1139992609024, 22.972999523162837, 24.3939995470047, 21.288999737739562, 25.915999403953553, 25.62399942779541, 26.27399940395355, 26.329999332427985, 23.34099952316284, 23.003999666213986, 26.054999499320985, 24.495999427795418, 24.199999523162838, 27.81899942779541, 24.206999523162843, 25.766999380111685, 26.42299940395355, 27.528999141693117, 24.071999570846558, 23.425999618530277, 23.591999523162837, 23.13399957084656, 24.328999499320986, 24.717999594688415, 27.016999332427986, 25.580999427795412, 24.011999403953553, 24.76899947547913, 25.903999475479125, 22.861999594688413], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9567487960693419, "mean_inference_ms": 0.8500569585202514, "mean_action_processing_ms": 0.09760381221056343, "mean_env_wait_ms": 0.05546317941721889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02601526000282981, "StateBufferConnector_ms": 0.03429976376620206, "ViewRequirementAgentConnector_ms": 0.2257624539462003}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 466.0328068760968, "num_env_steps_trained_throughput_per_sec": 466.0328068760968, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8583.056, "sample_time_ms": 3964.94, "load_time_ms": 0.445, "load_throughput": 8986189.609, "learn_time_ms": 4614.963, "learn_throughput": 866.746, "synch_weights_time_ms": 1.998}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 220, "training_iteration": 1, "trial_id": "6d576_00000", "date": "2023-08-26_17-01-38", "timestamp": 1693062098, "time_this_iter_s": 8.599287986755371, "time_total_s": 8.599287986755371, "pid": 39075, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc3042d94c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8.599287986755371, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.17692307692309, "ram_util_percent": 83.56153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.287428369397117, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2588183475357871, "policy_loss": -0.029566306462611564, "vf_loss": 0.2842415661260646, "vf_explained_var": 0.0, "kl": 0.04143088897491457, "entropy": 0.6597436698534156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 29.48999914169312, "episode_reward_min": 18.969999690055847, "episode_reward_mean": 24.56951149426651, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.78599930858612, 23.016999403953548, 26.34299945163727, 25.28099933242798, 26.05199940395356, 25.216999499320988, 22.733999833106992, 28.64399930858612, 25.922999523162837, 24.91199928474426, 22.855999642372133, 22.442999618530273, 23.570999547004707, 25.5329995470047, 24.406999666213988, 24.29899969005585, 22.68399964237213, 21.920999666213987, 25.63299938011169, 23.769999523162845, 25.29899945163726, 27.65499930858612, 27.165999332427983, 23.78799976158142, 27.77899935626984, 22.66599959468841, 24.13899945163727, 25.059999403953558, 25.911999427795408, 25.40599942779541, 24.711999594688418, 25.67399945163727, 24.663999475479123, 24.2219995470047, 25.471999427795414, 22.260999690055854, 25.55499942779541, 20.82799976158142, 25.00399969005585, 23.668999594688415, 23.867999666213993, 24.99699942779541, 21.770999594688416, 22.6919995470047, 21.28899978542328, 23.5539995470047, 23.23299976158143, 24.844999451637264, 23.58599964237213, 25.21099933242798, 22.559999666213987, 23.6689995470047, 23.88099952316284, 21.124999570846555, 23.586999642372128, 23.76399952316284, 23.418999427795413, 25.020999523162843, 23.787999594688415, 22.619999403953553, 22.744999594688416, 24.6089995470047, 23.136999761581414, 23.327999618530267, 24.97099952316284, 24.071999570846554, 22.13399964237213, 23.611999427795407, 24.686999427795413, 23.331999642372132, 24.480999356269837, 22.56299957084656, 28.28799930858612, 23.23399966621399, 22.36699957084656, 25.148999427795413, 22.33999945163727, 24.943999451637268, 22.563999666213988, 25.578999380111696, 22.44899980926514, 25.902999308586118, 23.089999594688415, 26.09899933242798, 21.7649995470047, 23.11599952316284, 22.91699971389771, 25.4419993801117, 24.33699957084656, 23.27199966621399, 22.21299942779541, 23.912999475479126, 21.288999666213993, 25.058999523162843, 24.8499995470047, 21.252999690055848, 24.10599969005585, 27.10699928474426, 24.3169995470047, 24.792999594688418, 23.81999957084656, 25.387999308586124, 25.321999547004697, 23.90599952316284, 23.932999570846555, 24.246999570846558, 21.820999594688416, 22.791999594688416, 24.773999403953546, 21.607999547004702, 27.636999427795406, 20.721999666213986, 23.923999594688418, 25.874999237060546, 25.803999475479127, 23.2599995470047, 25.531999499320985, 18.969999690055847, 21.864999523162847, 25.688999332427976, 23.783999475479124, 24.32899957084656, 23.626999618530274, 22.71299947547913, 27.756999308586117, 24.451999570846553, 27.34299933242798, 24.544999737739563, 22.751999523162844, 25.629999475479128, 24.211999690055848, 23.26699942779541, 27.43899921321869, 22.32299957084656, 22.600999475479128, 25.51499942779541, 23.617999475479124, 22.958999642372135, 25.52099942779541, 26.375999380111693, 26.388999570846554, 21.43199964237213, 27.064999403953554, 27.82999916553497, 23.321999618530274, 24.7979995470047, 24.95499940395355, 24.553999332427978, 26.089999380111696, 26.522999427795405, 21.67699976158142, 25.09199945163727, 27.48899949932098, 24.839999547004698, 22.90599976158142, 23.340999618530272, 25.145999523162843, 25.127999403953556, 29.48999914169312, 25.445999380111694, 23.916999570846556, 24.6179995470047, 26.0059993801117, 25.671999427795406, 25.399999260902405, 23.275999570846558, 25.290999547004702, 23.71899964237213, 25.60099940395355, 23.405999499320984, 27.785999380111697, 24.917999356269835, 25.805999594688412, 22.630999475479122, 24.184999380111694, 24.220999499320985, 25.69499959468842, 27.135999403953562, 23.105999618530273, 27.51599918937683, 23.877999594688415, 25.864999403953554, 23.320999618530273, 24.009999403953547, 25.87299918937683, 26.052999356269837, 25.254999380111695, 22.495999499320984, 23.83699947547912, 23.652999594688414, 25.931999403953558, 27.86999928474426, 28.076999475479123, 26.60699938011169, 26.252999332427983, 22.5589995470047, 24.020999618530276, 24.772999284744266, 24.01099945163727, 25.34599942779541, 23.67999961853027, 27.215999332427977, 25.15699945163727, 22.473999570846562, 26.067999260902404, 24.791999737739566, 22.610999499320986, 25.59299947547912, 25.741999356269844, 26.355999380111697, 26.23799938011169, 26.857999356269833, 22.5819995470047, 25.349999475479127, 27.090999284744264, 26.178999499320984, 25.122999451637266, 22.958999403953552, 25.484999332427982, 22.562999618530274, 23.874999523162845, 22.679999547004698, 23.701999594688417, 24.520999547004696, 25.029999547004696, 25.99099947547913, 26.15299940395355, 24.98499940395355, 24.475999499320988, 25.868999427795412, 25.075999523162846, 26.944999475479126, 26.50299942779541, 24.299999451637266, 27.57899928474426, 25.044999332427974, 25.40899940395356, 25.775999427795412, 24.732999523162842, 25.56199945163727, 25.340999451637266, 26.590999451637266, 26.732999308586116, 22.831999594688416, 25.02799952316284, 26.899999356269838, 24.02899945163727, 25.87599935626984, 24.250999547004703, 25.845999403953545], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0972665685678953, "mean_inference_ms": 0.9505547335433291, "mean_action_processing_ms": 0.10524636892877916, "mean_env_wait_ms": 0.060487019959106304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03136634826660156, "StateBufferConnector_ms": 0.04025583267211914, "ViewRequirementAgentConnector_ms": 0.26585960388183594}}, "episode_reward_max": 29.48999914169312, "episode_reward_min": 18.969999690055847, "episode_reward_mean": 24.56951149426651, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.78599930858612, 23.016999403953548, 26.34299945163727, 25.28099933242798, 26.05199940395356, 25.216999499320988, 22.733999833106992, 28.64399930858612, 25.922999523162837, 24.91199928474426, 22.855999642372133, 22.442999618530273, 23.570999547004707, 25.5329995470047, 24.406999666213988, 24.29899969005585, 22.68399964237213, 21.920999666213987, 25.63299938011169, 23.769999523162845, 25.29899945163726, 27.65499930858612, 27.165999332427983, 23.78799976158142, 27.77899935626984, 22.66599959468841, 24.13899945163727, 25.059999403953558, 25.911999427795408, 25.40599942779541, 24.711999594688418, 25.67399945163727, 24.663999475479123, 24.2219995470047, 25.471999427795414, 22.260999690055854, 25.55499942779541, 20.82799976158142, 25.00399969005585, 23.668999594688415, 23.867999666213993, 24.99699942779541, 21.770999594688416, 22.6919995470047, 21.28899978542328, 23.5539995470047, 23.23299976158143, 24.844999451637264, 23.58599964237213, 25.21099933242798, 22.559999666213987, 23.6689995470047, 23.88099952316284, 21.124999570846555, 23.586999642372128, 23.76399952316284, 23.418999427795413, 25.020999523162843, 23.787999594688415, 22.619999403953553, 22.744999594688416, 24.6089995470047, 23.136999761581414, 23.327999618530267, 24.97099952316284, 24.071999570846554, 22.13399964237213, 23.611999427795407, 24.686999427795413, 23.331999642372132, 24.480999356269837, 22.56299957084656, 28.28799930858612, 23.23399966621399, 22.36699957084656, 25.148999427795413, 22.33999945163727, 24.943999451637268, 22.563999666213988, 25.578999380111696, 22.44899980926514, 25.902999308586118, 23.089999594688415, 26.09899933242798, 21.7649995470047, 23.11599952316284, 22.91699971389771, 25.4419993801117, 24.33699957084656, 23.27199966621399, 22.21299942779541, 23.912999475479126, 21.288999666213993, 25.058999523162843, 24.8499995470047, 21.252999690055848, 24.10599969005585, 27.10699928474426, 24.3169995470047, 24.792999594688418, 23.81999957084656, 25.387999308586124, 25.321999547004697, 23.90599952316284, 23.932999570846555, 24.246999570846558, 21.820999594688416, 22.791999594688416, 24.773999403953546, 21.607999547004702, 27.636999427795406, 20.721999666213986, 23.923999594688418, 25.874999237060546, 25.803999475479127, 23.2599995470047, 25.531999499320985, 18.969999690055847, 21.864999523162847, 25.688999332427976, 23.783999475479124, 24.32899957084656, 23.626999618530274, 22.71299947547913, 27.756999308586117, 24.451999570846553, 27.34299933242798, 24.544999737739563, 22.751999523162844, 25.629999475479128, 24.211999690055848, 23.26699942779541, 27.43899921321869, 22.32299957084656, 22.600999475479128, 25.51499942779541, 23.617999475479124, 22.958999642372135, 25.52099942779541, 26.375999380111693, 26.388999570846554, 21.43199964237213, 27.064999403953554, 27.82999916553497, 23.321999618530274, 24.7979995470047, 24.95499940395355, 24.553999332427978, 26.089999380111696, 26.522999427795405, 21.67699976158142, 25.09199945163727, 27.48899949932098, 24.839999547004698, 22.90599976158142, 23.340999618530272, 25.145999523162843, 25.127999403953556, 29.48999914169312, 25.445999380111694, 23.916999570846556, 24.6179995470047, 26.0059993801117, 25.671999427795406, 25.399999260902405, 23.275999570846558, 25.290999547004702, 23.71899964237213, 25.60099940395355, 23.405999499320984, 27.785999380111697, 24.917999356269835, 25.805999594688412, 22.630999475479122, 24.184999380111694, 24.220999499320985, 25.69499959468842, 27.135999403953562, 23.105999618530273, 27.51599918937683, 23.877999594688415, 25.864999403953554, 23.320999618530273, 24.009999403953547, 25.87299918937683, 26.052999356269837, 25.254999380111695, 22.495999499320984, 23.83699947547912, 23.652999594688414, 25.931999403953558, 27.86999928474426, 28.076999475479123, 26.60699938011169, 26.252999332427983, 22.5589995470047, 24.020999618530276, 24.772999284744266, 24.01099945163727, 25.34599942779541, 23.67999961853027, 27.215999332427977, 25.15699945163727, 22.473999570846562, 26.067999260902404, 24.791999737739566, 22.610999499320986, 25.59299947547912, 25.741999356269844, 26.355999380111697, 26.23799938011169, 26.857999356269833, 22.5819995470047, 25.349999475479127, 27.090999284744264, 26.178999499320984, 25.122999451637266, 22.958999403953552, 25.484999332427982, 22.562999618530274, 23.874999523162845, 22.679999547004698, 23.701999594688417, 24.520999547004696, 25.029999547004696, 25.99099947547913, 26.15299940395355, 24.98499940395355, 24.475999499320988, 25.868999427795412, 25.075999523162846, 26.944999475479126, 26.50299942779541, 24.299999451637266, 27.57899928474426, 25.044999332427974, 25.40899940395356, 25.775999427795412, 24.732999523162842, 25.56199945163727, 25.340999451637266, 26.590999451637266, 26.732999308586116, 22.831999594688416, 25.02799952316284, 26.899999356269838, 24.02899945163727, 25.87599935626984, 24.250999547004703, 25.845999403953545], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0972665685678953, "mean_inference_ms": 0.9505547335433291, "mean_action_processing_ms": 0.10524636892877916, "mean_env_wait_ms": 0.060487019959106304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03136634826660156, "StateBufferConnector_ms": 0.04025583267211914, "ViewRequirementAgentConnector_ms": 0.26585960388183594}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.12869965510896, "num_env_steps_trained_throughput_per_sec": 416.12869965510896, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 9097.72, "sample_time_ms": 4477.26, "load_time_ms": 0.358, "load_throughput": 11173637.03, "learn_time_ms": 4617.354, "learn_throughput": 866.297, "synch_weights_time_ms": 2.039}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 470, "training_iteration": 2, "trial_id": "6d576_00000", "date": "2023-08-26_17-01-48", "timestamp": 1693062108, "time_this_iter_s": 9.629722595214844, "time_total_s": 18.229010581970215, "pid": 39075, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc3042d94c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 18.229010581970215, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 49.223076923076924, "ram_util_percent": 83.9230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0310924021847625, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23062566301675252, "policy_loss": -0.06624138294869374, "vf_loss": 0.29311472837642955, "vf_explained_var": 0.0, "kl": 0.025015448435141995, "entropy": 0.6918218156342866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 29.19399928474426, "episode_reward_min": 19.758999833106994, "episode_reward_mean": 24.89224345516586, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.672999594688413, 24.748999403953555, 25.95399935626984, 24.08299952316284, 19.758999833106994, 25.335999499320984, 24.483999380111687, 27.465999308586124, 24.40999964237213, 22.681999618530277, 24.527999547004697, 26.14999940395355, 23.336999380111696, 20.940999570846557, 22.871999570846558, 25.75099933242798, 24.4869995470047, 25.102999451637267, 21.843999451637266, 25.45499966621399, 27.27299921321869, 22.68099969005585, 23.84299935626984, 26.641999237060546, 23.09099952316284, 24.033999451637268, 25.35999940395356, 25.601999308586112, 23.713999570846557, 24.6039993801117, 26.32499961853027, 24.7939995470047, 24.15699952316284, 21.678999666213993, 23.584999499320983, 22.57199961853027, 23.493999594688415, 23.108999403953554, 24.52799949932098, 26.33799947547913, 23.938999523162845, 23.0669995470047, 23.263999451637268, 23.372999570846556, 24.48699966621399, 22.123999618530277, 26.080999380111695, 23.592999475479125, 23.795999594688418, 24.068999451637268, 25.06199952316284, 22.831999666213992, 25.5779995470047, 23.102999809265135, 22.974999523162843, 22.859999523162845, 23.272999451637272, 24.57699945163727, 24.557999499320985, 25.296999380111693, 24.28699940395355, 24.415999499320986, 25.86299933242798, 25.91299957084656, 26.266999403953548, 25.33299952316284, 25.13399945163727, 24.295999427795415, 23.7579995470047, 25.39899942779541, 25.824999547004698, 23.819999642372135, 24.42799966621399, 24.365999451637265, 24.93499952316284, 21.226999547004702, 23.575999499320982, 23.370999618530274, 25.01199957084656, 26.92599935626984, 21.152999642372126, 22.339999547004698, 24.008999523162842, 26.46399942779541, 24.930999356269833, 23.64799952316285, 24.556999499320984, 22.698999547004696, 27.037999475479126, 25.162999523162842, 21.802999451637266, 25.2159995470047, 27.451999427795407, 24.79499947547913, 23.86199952316284, 25.156999451637265, 23.358999690055846, 22.269999618530274, 23.20399942779541, 24.33999949932098, 22.509999618530273, 25.332999475479124, 25.21499945163727, 22.382999570846557, 25.581999451637266, 23.471999499320983, 24.520999499320986, 21.223999809265134, 23.76499945163727, 27.383999499320986, 24.49399942779541, 24.787999403953553, 26.111999523162847, 26.609999499320985, 24.607999499320986, 23.228999570846554, 25.86499949932098, 25.033999403953544, 25.791999475479127, 24.6879995470047, 25.033999403953544, 23.22799945163727, 23.6669995470047, 22.922999570846557, 23.570999547004703, 25.945999332427977, 24.75899942779541, 24.44999942779541, 25.85499947547913, 25.420999451637268, 24.138999499320985, 25.396999499320984, 27.177999332427976, 24.66699942779541, 23.265999499320984, 24.6639995470047, 25.54799930858612, 23.747999713897705, 25.765999475479124, 24.240999380111695, 24.370999427795407, 26.614999308586114, 25.180999380111686, 25.60399930858612, 25.043999380111696, 24.7179995470047, 27.20799928474426, 24.131999499320987, 27.32199933242798, 26.364999332427978, 25.63899923706055, 25.01899952316284, 23.936999570846556, 25.000999332427984, 22.37999942779541, 27.566999308586123, 25.85099940395355, 28.694999189376833, 27.765999356269838, 22.392999594688415, 23.825999475479126, 26.322999499320986, 26.25299933242798, 26.75699930858612, 26.5849993801117, 21.80299959468842, 24.85599935626983, 24.13699945163727, 24.237999332427975, 26.550999403953558, 27.46699926090241, 24.13799959468842, 26.640999547004704, 25.256999499320983, 24.997999237060544, 25.645999356269837, 24.06399945163727, 26.692999356269837, 26.218999260902404, 25.650999356269843, 23.331999380111693, 26.270999403953553, 29.19399928474426, 24.01699949932098, 25.012999475479127, 26.611999380111694, 25.4829993801117, 26.85899928474426, 25.377999380111696, 23.33599961853027, 25.47599969005585, 25.661999308586125, 26.13099940395355, 28.37799933242798, 25.44699949932098, 25.88299935626984, 24.053999523162844, 26.86599930858612, 25.906999547004705, 24.74899942779541, 23.74399942779541, 25.573999356269837, 26.4759992609024, 22.381999594688416, 27.821999308586122, 24.117999451637267, 24.081999332427976, 26.17699928474426, 26.210999356269834, 27.146999380111694, 24.589999547004695, 27.88799916553498, 25.99199928474426, 25.794999499320983, 25.881999332427977, 25.132999403953555, 25.729999356269833, 26.86099928474426, 28.977999284744264, 21.975999523162844, 26.78699935626984, 24.84399952316284, 26.37099945163727, 23.61599966621399, 27.242999165534968, 25.171999451637266, 26.92399923706055, 25.234999260902406, 26.904999213218687, 25.138999570846558, 26.00499928474427, 23.533999475479128, 22.498999618530274, 24.408999356269838, 27.39599930858612, 24.651999356269833, 26.791999427795417, 28.006999165534975, 25.523999475479123, 25.437999499320984, 24.32799952316284, 25.84299942779541, 28.722999189376832, 25.747999237060547, 23.81599957084656, 25.088999332427978, 24.045999570846558, 25.791999403953557, 23.963999570846557, 24.616999380111697], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2337890312564792, "mean_inference_ms": 1.019852516194658, "mean_action_processing_ms": 0.11340385078489931, "mean_env_wait_ms": 0.06582454490057728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034714889526367185, "StateBufferConnector_ms": 0.0467585563659668, "ViewRequirementAgentConnector_ms": 0.30785694122314455}}, "episode_reward_max": 29.19399928474426, "episode_reward_min": 19.758999833106994, "episode_reward_mean": 24.89224345516586, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.672999594688413, 24.748999403953555, 25.95399935626984, 24.08299952316284, 19.758999833106994, 25.335999499320984, 24.483999380111687, 27.465999308586124, 24.40999964237213, 22.681999618530277, 24.527999547004697, 26.14999940395355, 23.336999380111696, 20.940999570846557, 22.871999570846558, 25.75099933242798, 24.4869995470047, 25.102999451637267, 21.843999451637266, 25.45499966621399, 27.27299921321869, 22.68099969005585, 23.84299935626984, 26.641999237060546, 23.09099952316284, 24.033999451637268, 25.35999940395356, 25.601999308586112, 23.713999570846557, 24.6039993801117, 26.32499961853027, 24.7939995470047, 24.15699952316284, 21.678999666213993, 23.584999499320983, 22.57199961853027, 23.493999594688415, 23.108999403953554, 24.52799949932098, 26.33799947547913, 23.938999523162845, 23.0669995470047, 23.263999451637268, 23.372999570846556, 24.48699966621399, 22.123999618530277, 26.080999380111695, 23.592999475479125, 23.795999594688418, 24.068999451637268, 25.06199952316284, 22.831999666213992, 25.5779995470047, 23.102999809265135, 22.974999523162843, 22.859999523162845, 23.272999451637272, 24.57699945163727, 24.557999499320985, 25.296999380111693, 24.28699940395355, 24.415999499320986, 25.86299933242798, 25.91299957084656, 26.266999403953548, 25.33299952316284, 25.13399945163727, 24.295999427795415, 23.7579995470047, 25.39899942779541, 25.824999547004698, 23.819999642372135, 24.42799966621399, 24.365999451637265, 24.93499952316284, 21.226999547004702, 23.575999499320982, 23.370999618530274, 25.01199957084656, 26.92599935626984, 21.152999642372126, 22.339999547004698, 24.008999523162842, 26.46399942779541, 24.930999356269833, 23.64799952316285, 24.556999499320984, 22.698999547004696, 27.037999475479126, 25.162999523162842, 21.802999451637266, 25.2159995470047, 27.451999427795407, 24.79499947547913, 23.86199952316284, 25.156999451637265, 23.358999690055846, 22.269999618530274, 23.20399942779541, 24.33999949932098, 22.509999618530273, 25.332999475479124, 25.21499945163727, 22.382999570846557, 25.581999451637266, 23.471999499320983, 24.520999499320986, 21.223999809265134, 23.76499945163727, 27.383999499320986, 24.49399942779541, 24.787999403953553, 26.111999523162847, 26.609999499320985, 24.607999499320986, 23.228999570846554, 25.86499949932098, 25.033999403953544, 25.791999475479127, 24.6879995470047, 25.033999403953544, 23.22799945163727, 23.6669995470047, 22.922999570846557, 23.570999547004703, 25.945999332427977, 24.75899942779541, 24.44999942779541, 25.85499947547913, 25.420999451637268, 24.138999499320985, 25.396999499320984, 27.177999332427976, 24.66699942779541, 23.265999499320984, 24.6639995470047, 25.54799930858612, 23.747999713897705, 25.765999475479124, 24.240999380111695, 24.370999427795407, 26.614999308586114, 25.180999380111686, 25.60399930858612, 25.043999380111696, 24.7179995470047, 27.20799928474426, 24.131999499320987, 27.32199933242798, 26.364999332427978, 25.63899923706055, 25.01899952316284, 23.936999570846556, 25.000999332427984, 22.37999942779541, 27.566999308586123, 25.85099940395355, 28.694999189376833, 27.765999356269838, 22.392999594688415, 23.825999475479126, 26.322999499320986, 26.25299933242798, 26.75699930858612, 26.5849993801117, 21.80299959468842, 24.85599935626983, 24.13699945163727, 24.237999332427975, 26.550999403953558, 27.46699926090241, 24.13799959468842, 26.640999547004704, 25.256999499320983, 24.997999237060544, 25.645999356269837, 24.06399945163727, 26.692999356269837, 26.218999260902404, 25.650999356269843, 23.331999380111693, 26.270999403953553, 29.19399928474426, 24.01699949932098, 25.012999475479127, 26.611999380111694, 25.4829993801117, 26.85899928474426, 25.377999380111696, 23.33599961853027, 25.47599969005585, 25.661999308586125, 26.13099940395355, 28.37799933242798, 25.44699949932098, 25.88299935626984, 24.053999523162844, 26.86599930858612, 25.906999547004705, 24.74899942779541, 23.74399942779541, 25.573999356269837, 26.4759992609024, 22.381999594688416, 27.821999308586122, 24.117999451637267, 24.081999332427976, 26.17699928474426, 26.210999356269834, 27.146999380111694, 24.589999547004695, 27.88799916553498, 25.99199928474426, 25.794999499320983, 25.881999332427977, 25.132999403953555, 25.729999356269833, 26.86099928474426, 28.977999284744264, 21.975999523162844, 26.78699935626984, 24.84399952316284, 26.37099945163727, 23.61599966621399, 27.242999165534968, 25.171999451637266, 26.92399923706055, 25.234999260902406, 26.904999213218687, 25.138999570846558, 26.00499928474427, 23.533999475479128, 22.498999618530274, 24.408999356269838, 27.39599930858612, 24.651999356269833, 26.791999427795417, 28.006999165534975, 25.523999475479123, 25.437999499320984, 24.32799952316284, 25.84299942779541, 28.722999189376832, 25.747999237060547, 23.81599957084656, 25.088999332427978, 24.045999570846558, 25.791999403953557, 23.963999570846557, 24.616999380111697], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2337890312564792, "mean_inference_ms": 1.019852516194658, "mean_action_processing_ms": 0.11340385078489931, "mean_env_wait_ms": 0.06582454490057728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034714889526367185, "StateBufferConnector_ms": 0.0467585563659668, "ViewRequirementAgentConnector_ms": 0.30785694122314455}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.09123680887393, "num_env_steps_trained_throughput_per_sec": 383.09123680887393, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 9545.596, "sample_time_ms": 4915.226, "load_time_ms": 0.332, "load_throughput": 12064153.404, "learn_time_ms": 4627.249, "learn_throughput": 864.445, "synch_weights_time_ms": 2.092}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": true, "episodes_total": 720, "training_iteration": 3, "trial_id": "6d576_00000", "date": "2023-08-26_17-01-58", "timestamp": 1693062118, "time_this_iter_s": 10.453938245773315, "time_total_s": 28.68294882774353, "pid": 39075, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc3042d94c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 28.68294882774353, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 53.38666666666667, "ram_util_percent": 83.87999999999998}}
