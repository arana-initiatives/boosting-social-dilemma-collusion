{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.3769596318243655, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5013612394050886, "policy_loss": -0.006470481586712663, "vf_loss": 1.5061294728068895, "vf_explained_var": -0.002388663189385527, "kl": 0.008511193644321744, "entropy": 0.6845389322568012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 421.08199034404737, "episode_reward_min": 18.159999690055848, "episode_reward_mean": 28.378008483483576, "episode_len_mean": 18.181818181818183, "episode_media": {}, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [421.08199034404737, 25.436999499320986, 27.811999165534974, 24.861999475479124, 26.29099942779541, 25.3269995470047, 21.25799949932098, 26.21699933242798, 27.403999356269836, 28.50299918937683, 27.024999451637267, 25.855999356269834, 28.627999189376833, 24.68999945163727, 28.0969990940094, 27.082999475479127, 26.06999952316284, 27.694999260902406, 28.603999308586122, 27.956999237060547, 26.817999237060555, 25.55099945163727, 27.43699933242798, 26.765999403953547, 26.53199935626983, 28.260999284744265, 25.713999380111694, 26.17399945163727, 25.906999284744263, 26.72099921321869, 27.50499942779541, 25.950999356269836, 29.257999451637268, 29.068999475479124, 26.606999475479125, 25.909999475479125, 19.989999523162847, 26.702999403953548, 26.4989995470047, 26.414999499320984, 25.72699940395355, 28.723999237060546, 28.909999284744263, 26.97399921321869, 28.39199916553497, 29.371999141693117, 28.423999189376826, 27.828999403953556, 25.18399947547912, 27.149999451637267, 27.885999284744262, 29.706999260902407, 26.20099935626984, 27.09599935626984, 26.18599952316284, 26.164999284744262, 26.816999189376833, 27.635999141693112, 28.309999332427978, 26.531999403953556, 27.71899930858612, 24.530999427795404, 28.98499911785126, 27.130999403953556, 26.422999427795407, 29.37699916553497, 26.616999356269837, 28.371999141693113, 25.223999523162842, 28.375999260902404, 27.46799926090241, 26.960999356269834, 26.408999308586118, 26.36499930858612, 27.19599933242798, 25.56399930858612, 25.659999475479125, 27.12099938011169, 27.50199918937683, 27.659999308586116, 30.4159990940094, 28.41699921321869, 25.617999356269838, 27.684999165534975, 26.74499928474426, 28.16499921321869, 27.477999213218688, 26.896999475479124, 27.171999403953553, 25.660999475479127, 28.483999213218688, 26.87099947547913, 29.72399930858612, 26.2689993801117, 26.151999523162843, 28.105999213218688, 26.936999523162843, 26.972999332427978, 26.70599940395355, 27.662999189376823, 28.096999308586124, 26.552999403953546, 26.17199952316284, 26.781999427795412, 28.295999284744262, 27.84399947547913, 23.914999475479124, 23.681999427795414, 29.567999094009398, 24.206999690055845, 357.2169936103818, 23.14199964237213, 21.823999761581423, 23.247999690055853, 23.004999451637264, 24.875999547004703, 23.071999761581427, 25.779999499320986, 23.898999451637266, 24.555999618530272, 25.228999690055847, 24.179999451637272, 21.611999666213986, 22.93899959468841, 22.73699966621399, 23.952999570846558, 25.00599921321869, 19.672999856948845, 23.386999618530275, 18.159999690055848, 20.670999856948853, 25.586999308586122, 22.644999570846554, 24.20899964237213, 23.939999451637267, 22.134999713897706, 26.06299940395355, 21.588999618530273, 26.20599933242798, 23.138999570846558, 23.92799952316284, 23.464999547004695, 21.00699973773956, 24.305999499320983, 25.200999380111693, 22.20299961853027, 21.55299973773956, 24.70899961853027, 24.509999618530276, 22.069999642372128, 20.816999761581425, 23.83699949932098, 20.317999666213993, 21.1429995470047, 25.787999547004702, 22.570999666213993, 23.571999618530274, 23.497999618530272, 20.442999666213982, 21.602999547004696, 22.416999475479123, 23.419999737739563, 24.36999952316284, 22.277999570846557, 23.32999952316284, 22.894999570846558, 23.941999475479125, 25.159999570846555, 23.384999451637267, 22.883999666213988, 23.233999499320984, 21.832999618530273, 24.03899947547912, 26.244999284744264, 24.410999666213993, 21.82299957084656, 21.66599964237214, 20.213999737739563, 24.78799947547913, 25.031999523162842, 23.039999570846554, 24.228999499320977, 19.43399978542328, 23.626999594688417, 24.30999938011169, 21.916999713897702, 24.451999499320983, 22.63699961853027, 23.667999547004705, 24.326999499320983, 22.940999475479128, 24.66799935626984, 23.29999957084656, 22.018999690055846, 23.536999547004697, 22.25599949932099, 25.230999570846556, 26.613999547004703, 24.22799945163727, 23.963999594688413, 23.559999570846553, 22.611999713897706, 23.177999499320986, 22.34199957084656, 22.000999523162847, 23.759999523162843, 22.633999547004702, 22.817999642372133, 24.4599995470047, 23.367999713897706, 22.73499945163727, 22.870999523162844, 22.674999642372136, 20.25999985694885, 23.940999451637268, 22.620999666213994, 22.53399966621399, 22.457999475479127, 24.741999403953553, 20.78199947547913], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8742501889390389, "mean_inference_ms": 0.7914833162261031, "mean_action_processing_ms": 0.0882256573167579, "mean_env_wait_ms": 0.05290580951589636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0235637751492587, "StateBufferConnector_ms": 0.030808123675259678, "ViewRequirementAgentConnector_ms": 0.206497690894387}}, "episode_reward_max": 421.08199034404737, "episode_reward_min": 18.159999690055848, "episode_reward_mean": 28.378008483483576, "episode_len_mean": 18.181818181818183, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [421.08199034404737, 25.436999499320986, 27.811999165534974, 24.861999475479124, 26.29099942779541, 25.3269995470047, 21.25799949932098, 26.21699933242798, 27.403999356269836, 28.50299918937683, 27.024999451637267, 25.855999356269834, 28.627999189376833, 24.68999945163727, 28.0969990940094, 27.082999475479127, 26.06999952316284, 27.694999260902406, 28.603999308586122, 27.956999237060547, 26.817999237060555, 25.55099945163727, 27.43699933242798, 26.765999403953547, 26.53199935626983, 28.260999284744265, 25.713999380111694, 26.17399945163727, 25.906999284744263, 26.72099921321869, 27.50499942779541, 25.950999356269836, 29.257999451637268, 29.068999475479124, 26.606999475479125, 25.909999475479125, 19.989999523162847, 26.702999403953548, 26.4989995470047, 26.414999499320984, 25.72699940395355, 28.723999237060546, 28.909999284744263, 26.97399921321869, 28.39199916553497, 29.371999141693117, 28.423999189376826, 27.828999403953556, 25.18399947547912, 27.149999451637267, 27.885999284744262, 29.706999260902407, 26.20099935626984, 27.09599935626984, 26.18599952316284, 26.164999284744262, 26.816999189376833, 27.635999141693112, 28.309999332427978, 26.531999403953556, 27.71899930858612, 24.530999427795404, 28.98499911785126, 27.130999403953556, 26.422999427795407, 29.37699916553497, 26.616999356269837, 28.371999141693113, 25.223999523162842, 28.375999260902404, 27.46799926090241, 26.960999356269834, 26.408999308586118, 26.36499930858612, 27.19599933242798, 25.56399930858612, 25.659999475479125, 27.12099938011169, 27.50199918937683, 27.659999308586116, 30.4159990940094, 28.41699921321869, 25.617999356269838, 27.684999165534975, 26.74499928474426, 28.16499921321869, 27.477999213218688, 26.896999475479124, 27.171999403953553, 25.660999475479127, 28.483999213218688, 26.87099947547913, 29.72399930858612, 26.2689993801117, 26.151999523162843, 28.105999213218688, 26.936999523162843, 26.972999332427978, 26.70599940395355, 27.662999189376823, 28.096999308586124, 26.552999403953546, 26.17199952316284, 26.781999427795412, 28.295999284744262, 27.84399947547913, 23.914999475479124, 23.681999427795414, 29.567999094009398, 24.206999690055845, 357.2169936103818, 23.14199964237213, 21.823999761581423, 23.247999690055853, 23.004999451637264, 24.875999547004703, 23.071999761581427, 25.779999499320986, 23.898999451637266, 24.555999618530272, 25.228999690055847, 24.179999451637272, 21.611999666213986, 22.93899959468841, 22.73699966621399, 23.952999570846558, 25.00599921321869, 19.672999856948845, 23.386999618530275, 18.159999690055848, 20.670999856948853, 25.586999308586122, 22.644999570846554, 24.20899964237213, 23.939999451637267, 22.134999713897706, 26.06299940395355, 21.588999618530273, 26.20599933242798, 23.138999570846558, 23.92799952316284, 23.464999547004695, 21.00699973773956, 24.305999499320983, 25.200999380111693, 22.20299961853027, 21.55299973773956, 24.70899961853027, 24.509999618530276, 22.069999642372128, 20.816999761581425, 23.83699949932098, 20.317999666213993, 21.1429995470047, 25.787999547004702, 22.570999666213993, 23.571999618530274, 23.497999618530272, 20.442999666213982, 21.602999547004696, 22.416999475479123, 23.419999737739563, 24.36999952316284, 22.277999570846557, 23.32999952316284, 22.894999570846558, 23.941999475479125, 25.159999570846555, 23.384999451637267, 22.883999666213988, 23.233999499320984, 21.832999618530273, 24.03899947547912, 26.244999284744264, 24.410999666213993, 21.82299957084656, 21.66599964237214, 20.213999737739563, 24.78799947547913, 25.031999523162842, 23.039999570846554, 24.228999499320977, 19.43399978542328, 23.626999594688417, 24.30999938011169, 21.916999713897702, 24.451999499320983, 22.63699961853027, 23.667999547004705, 24.326999499320983, 22.940999475479128, 24.66799935626984, 23.29999957084656, 22.018999690055846, 23.536999547004697, 22.25599949932099, 25.230999570846556, 26.613999547004703, 24.22799945163727, 23.963999594688413, 23.559999570846553, 22.611999713897706, 23.177999499320986, 22.34199957084656, 22.000999523162847, 23.759999523162843, 22.633999547004702, 22.817999642372133, 24.4599995470047, 23.367999713897706, 22.73499945163727, 22.870999523162844, 22.674999642372136, 20.25999985694885, 23.940999451637268, 22.620999666213994, 22.53399966621399, 22.457999475479127, 24.741999403953553, 20.78199947547913], "episode_lengths": [256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 256, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8742501889390389, "mean_inference_ms": 0.7914833162261031, "mean_action_processing_ms": 0.0882256573167579, "mean_env_wait_ms": 0.05290580951589636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0235637751492587, "StateBufferConnector_ms": 0.030808123675259678, "ViewRequirementAgentConnector_ms": 0.206497690894387}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.776881221603, "num_env_steps_trained_throughput_per_sec": 481.776881221603, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 8302.566, "sample_time_ms": 3643.636, "load_time_ms": 0.458, "load_throughput": 8724501.3, "learn_time_ms": 4655.399, "learn_throughput": 859.217, "synch_weights_time_ms": 2.316}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 220, "training_iteration": 1, "trial_id": "3a6ba_00000", "date": "2023-08-26_17-00-13", "timestamp": 1693062013, "time_this_iter_s": 8.3142991065979, "time_total_s": 8.3142991065979, "pid": 37617, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ff1ecf4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8.3142991065979, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.46666666666667, "ram_util_percent": 83.55833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.699042008000036, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2794556997918511, "policy_loss": -0.0029751325166353614, "vf_loss": 0.2824167797161687, "vf_explained_var": 0.0, "kl": 7.026858468497687e-05, "entropy": 0.6843703282135789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 30.511999022483828, "episode_reward_min": 19.06699988079071, "episode_reward_mean": 25.396847431800843, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.310999260902403, 26.706999332427984, 26.511999380111696, 27.812999403953548, 23.432999427795412, 27.573999260902408, 27.93299923706055, 25.66799935626984, 28.411999308586125, 28.40399926090241, 27.411999308586125, 26.04899947547913, 25.09799947547912, 27.53299930858612, 25.11099952316284, 27.07299933242798, 25.6719995470047, 26.92399938011169, 27.840999284744267, 26.334999451637273, 28.144999213218682, 26.83299935626983, 30.10899904632568, 25.232999427795413, 27.7939990940094, 28.361999213218688, 25.94399933242798, 28.25999916553498, 28.05499916553497, 28.108999332427977, 26.827999475479128, 26.533999594688417, 27.617999308586118, 28.101999213218683, 26.10699945163727, 30.162999165534973, 28.705999117851263, 28.827999046325687, 26.880999403953552, 24.85399947547912, 28.00799928474426, 27.018999213218684, 27.86999928474426, 27.691999260902406, 25.623999475479128, 29.460999308586118, 28.389999260902403, 27.4349992609024, 27.37799914169311, 26.86399918937683, 27.92399933242798, 25.258999403953553, 24.252999427795412, 29.78499902248382, 27.572999260902407, 29.45899940395355, 26.942999523162843, 28.705999117851263, 28.490999260902406, 25.97699940395355, 27.461999332427975, 29.441999141693117, 27.153999380111692, 28.539999260902405, 29.825999308586127, 27.63799942779541, 27.074999451637268, 28.14799918937683, 27.300999380111694, 26.998999403953555, 28.049999165534974, 26.68799949932098, 27.946999332427986, 27.17399921321869, 28.300999356269834, 29.051998998641967, 28.0629992609024, 24.038999475479123, 24.2979995470047, 28.89099918937683, 29.26499904632568, 24.95399952316284, 28.470999189376833, 28.964999237060542, 28.259999260902404, 27.355999260902408, 27.527999260902398, 27.586999499320978, 24.48999942779541, 28.208999332427982, 27.78399918937683, 28.930999237060544, 26.884999332427974, 26.052999427795413, 26.201999451637267, 28.20299914169311, 28.101999332427983, 26.901999380111693, 26.673999189376826, 26.47399930858612, 28.079999213218688, 25.914999260902405, 27.17699940395355, 30.214999165534973, 26.04499940395355, 28.4989992609024, 28.64599914169312, 26.0689993801117, 28.32299921321868, 29.445999427795407, 26.854999403953556, 27.598999356269836, 28.545999189376836, 28.133999094009397, 26.949999237060545, 26.94099928474426, 28.558999189376838, 30.511999022483828, 25.993999403953552, 28.55899935626984, 26.086999427795412, 28.39199916553497, 26.48199961853027, 29.938999046325684, 29.195999213218688, 20.613999594688416, 21.841999451637264, 23.650999499320985, 25.038999356269837, 23.436999594688416, 25.78099942779541, 22.758999666213985, 25.322999523162842, 24.8759995470047, 21.55299978542328, 22.761999523162842, 25.138999356269835, 23.175999570846557, 23.31799940395355, 25.727999570846556, 23.738999594688416, 24.154999332427977, 24.13899957084656, 21.98599976158142, 23.85899952316284, 21.74699952316284, 22.939999475479127, 25.103999570846558, 23.395999618530272, 22.38999969005585, 22.09199964237213, 23.11599945163727, 20.916999761581422, 21.663999523162843, 24.770999499320986, 21.91699957084656, 24.318999499320988, 22.06299945163727, 21.902999761581423, 22.125999523162843, 22.37399957084656, 24.75399942779541, 23.174999451637273, 22.388999737739564, 24.26899945163727, 21.592999666213988, 25.22799957084656, 22.378999737739566, 24.883999451637266, 21.828999713897705, 24.628999499320983, 23.958999594688414, 20.098999594688415, 23.23699945163727, 21.98999966621399, 24.444999499320982, 21.257999737739564, 21.80799966621399, 20.716999713897707, 23.835999594688417, 23.509999570846556, 23.191999451637265, 21.903999594688415, 24.65499942779541, 24.944999475479122, 23.076999713897706, 24.534999570846562, 24.635999427795408, 24.6599995470047, 22.936999618530272, 23.63299966621399, 23.863999570846556, 23.031999642372128, 21.695999666213993, 23.64399957084656, 25.090999475479123, 23.149999594688417, 25.53399945163727, 19.738999928474428, 23.697999499320986, 23.125999570846556, 22.884999523162847, 23.122999594688416, 24.095999499320982, 22.904999642372132, 24.923999427795408, 25.63599947547913, 25.687999356269838, 21.39599966621399, 23.98199952316284, 23.503999570846567, 26.175999451637267, 25.905999332427978, 24.139999594688415, 24.691999475479125, 22.8009995470047, 23.03199964237213, 24.39699949932098, 21.84699973773956, 24.001999499320984, 23.67399949932098, 22.68499945163726, 24.69099942779541, 23.927999523162843, 22.29399957084656, 24.644999475479132, 23.34599961853027, 25.03399938011169, 23.418999618530275, 23.634999475479123, 21.775999475479125, 26.124999403953552, 20.056999594688413, 25.38599938011169, 24.051999642372127, 22.622999618530272, 21.523999618530272, 25.530999547004704, 21.912999690055845, 19.06699988079071, 21.585999785423276, 23.411999618530274, 24.32799945163727, 23.25199980926514, 23.240999570846558, 22.21699957084656, 21.94699964237213, 23.490999618530275, 23.563999403953556, 21.251999499320988], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0012703161184804, "mean_inference_ms": 0.8782625973030975, "mean_action_processing_ms": 0.09565331345348173, "mean_env_wait_ms": 0.05808951585956051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027066421508789063, "StateBufferConnector_ms": 0.03634099960327149, "ViewRequirementAgentConnector_ms": 0.24277973175048828}}, "episode_reward_max": 30.511999022483828, "episode_reward_min": 19.06699988079071, "episode_reward_mean": 25.396847431800843, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.310999260902403, 26.706999332427984, 26.511999380111696, 27.812999403953548, 23.432999427795412, 27.573999260902408, 27.93299923706055, 25.66799935626984, 28.411999308586125, 28.40399926090241, 27.411999308586125, 26.04899947547913, 25.09799947547912, 27.53299930858612, 25.11099952316284, 27.07299933242798, 25.6719995470047, 26.92399938011169, 27.840999284744267, 26.334999451637273, 28.144999213218682, 26.83299935626983, 30.10899904632568, 25.232999427795413, 27.7939990940094, 28.361999213218688, 25.94399933242798, 28.25999916553498, 28.05499916553497, 28.108999332427977, 26.827999475479128, 26.533999594688417, 27.617999308586118, 28.101999213218683, 26.10699945163727, 30.162999165534973, 28.705999117851263, 28.827999046325687, 26.880999403953552, 24.85399947547912, 28.00799928474426, 27.018999213218684, 27.86999928474426, 27.691999260902406, 25.623999475479128, 29.460999308586118, 28.389999260902403, 27.4349992609024, 27.37799914169311, 26.86399918937683, 27.92399933242798, 25.258999403953553, 24.252999427795412, 29.78499902248382, 27.572999260902407, 29.45899940395355, 26.942999523162843, 28.705999117851263, 28.490999260902406, 25.97699940395355, 27.461999332427975, 29.441999141693117, 27.153999380111692, 28.539999260902405, 29.825999308586127, 27.63799942779541, 27.074999451637268, 28.14799918937683, 27.300999380111694, 26.998999403953555, 28.049999165534974, 26.68799949932098, 27.946999332427986, 27.17399921321869, 28.300999356269834, 29.051998998641967, 28.0629992609024, 24.038999475479123, 24.2979995470047, 28.89099918937683, 29.26499904632568, 24.95399952316284, 28.470999189376833, 28.964999237060542, 28.259999260902404, 27.355999260902408, 27.527999260902398, 27.586999499320978, 24.48999942779541, 28.208999332427982, 27.78399918937683, 28.930999237060544, 26.884999332427974, 26.052999427795413, 26.201999451637267, 28.20299914169311, 28.101999332427983, 26.901999380111693, 26.673999189376826, 26.47399930858612, 28.079999213218688, 25.914999260902405, 27.17699940395355, 30.214999165534973, 26.04499940395355, 28.4989992609024, 28.64599914169312, 26.0689993801117, 28.32299921321868, 29.445999427795407, 26.854999403953556, 27.598999356269836, 28.545999189376836, 28.133999094009397, 26.949999237060545, 26.94099928474426, 28.558999189376838, 30.511999022483828, 25.993999403953552, 28.55899935626984, 26.086999427795412, 28.39199916553497, 26.48199961853027, 29.938999046325684, 29.195999213218688, 20.613999594688416, 21.841999451637264, 23.650999499320985, 25.038999356269837, 23.436999594688416, 25.78099942779541, 22.758999666213985, 25.322999523162842, 24.8759995470047, 21.55299978542328, 22.761999523162842, 25.138999356269835, 23.175999570846557, 23.31799940395355, 25.727999570846556, 23.738999594688416, 24.154999332427977, 24.13899957084656, 21.98599976158142, 23.85899952316284, 21.74699952316284, 22.939999475479127, 25.103999570846558, 23.395999618530272, 22.38999969005585, 22.09199964237213, 23.11599945163727, 20.916999761581422, 21.663999523162843, 24.770999499320986, 21.91699957084656, 24.318999499320988, 22.06299945163727, 21.902999761581423, 22.125999523162843, 22.37399957084656, 24.75399942779541, 23.174999451637273, 22.388999737739564, 24.26899945163727, 21.592999666213988, 25.22799957084656, 22.378999737739566, 24.883999451637266, 21.828999713897705, 24.628999499320983, 23.958999594688414, 20.098999594688415, 23.23699945163727, 21.98999966621399, 24.444999499320982, 21.257999737739564, 21.80799966621399, 20.716999713897707, 23.835999594688417, 23.509999570846556, 23.191999451637265, 21.903999594688415, 24.65499942779541, 24.944999475479122, 23.076999713897706, 24.534999570846562, 24.635999427795408, 24.6599995470047, 22.936999618530272, 23.63299966621399, 23.863999570846556, 23.031999642372128, 21.695999666213993, 23.64399957084656, 25.090999475479123, 23.149999594688417, 25.53399945163727, 19.738999928474428, 23.697999499320986, 23.125999570846556, 22.884999523162847, 23.122999594688416, 24.095999499320982, 22.904999642372132, 24.923999427795408, 25.63599947547913, 25.687999356269838, 21.39599966621399, 23.98199952316284, 23.503999570846567, 26.175999451637267, 25.905999332427978, 24.139999594688415, 24.691999475479125, 22.8009995470047, 23.03199964237213, 24.39699949932098, 21.84699973773956, 24.001999499320984, 23.67399949932098, 22.68499945163726, 24.69099942779541, 23.927999523162843, 22.29399957084656, 24.644999475479132, 23.34599961853027, 25.03399938011169, 23.418999618530275, 23.634999475479123, 21.775999475479125, 26.124999403953552, 20.056999594688413, 25.38599938011169, 24.051999642372127, 22.622999618530272, 21.523999618530272, 25.530999547004704, 21.912999690055845, 19.06699988079071, 21.585999785423276, 23.411999618530274, 24.32799945163727, 23.25199980926514, 23.240999570846558, 22.21699957084656, 21.94699964237213, 23.490999618530275, 23.563999403953556, 21.251999499320988], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0012703161184804, "mean_inference_ms": 0.8782625973030975, "mean_action_processing_ms": 0.09565331345348173, "mean_env_wait_ms": 0.05808951585956051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027066421508789063, "StateBufferConnector_ms": 0.03634099960327149, "ViewRequirementAgentConnector_ms": 0.24277973175048828}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.36939820890836, "num_env_steps_trained_throughput_per_sec": 436.36939820890836, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 8734.544, "sample_time_ms": 4097.045, "load_time_ms": 0.354, "load_throughput": 11290185.734, "learn_time_ms": 4634.323, "learn_throughput": 863.125, "synch_weights_time_ms": 2.11}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 470, "training_iteration": 2, "trial_id": "3a6ba_00000", "date": "2023-08-26_17-00-22", "timestamp": 1693062022, "time_this_iter_s": 9.178763151168823, "time_total_s": 17.493062257766724, "pid": 37617, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ff1ecf4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 17.493062257766724, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.19230769230769, "ram_util_percent": 83.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.610382835390747, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2130123724469975, "policy_loss": -0.11149349130930439, "vf_loss": 0.3190250372694385, "vf_explained_var": 0.0, "kl": 0.054808262900901746, "entropy": 0.6755442983360701, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 30.555999022483824, "episode_reward_min": 20.11699966621399, "episode_reward_mean": 25.23053543265915, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.514999165534974, 29.866999165534974, 26.85699942779541, 26.66799930858612, 28.470999189376833, 28.80299911785126, 27.46399930858612, 24.133999380111693, 26.597999356269835, 25.110999499320982, 27.479999308586123, 27.30099928474426, 28.569999284744267, 25.172999403953554, 25.572999356269836, 28.583999189376833, 28.249999260902406, 30.09799916553497, 24.16299947547913, 27.791999237060544, 27.50699938011169, 28.960999165534975, 24.955999523162845, 28.012999403953554, 27.19499930858612, 26.994999427795413, 25.23899933242798, 29.110999141693114, 29.30399916553498, 25.871999284744255, 28.98399911785126, 27.69399923706055, 25.089999570846555, 29.467999070167544, 28.187999213218692, 26.459999380111693, 28.852999284744257, 28.989999165534975, 25.67099942779541, 27.974999260902404, 27.52799916553498, 30.555999022483824, 29.201999260902404, 26.265999380111694, 29.505999070167547, 28.787999237060546, 29.996999284744263, 29.57299899864197, 26.285999260902408, 28.03299928474426, 27.549999308586127, 26.237999332427975, 27.103999165534976, 30.021999070167542, 28.87899923706055, 25.950999260902407, 28.045999094009403, 23.19699942779541, 27.51399933242798, 27.56999918937683, 27.228999308586125, 25.20599945163727, 25.935999475479125, 27.256999332427974, 27.537999213218686, 25.81499952316284, 27.120999165534972, 26.858999356269834, 28.186999332427977, 26.90899935626984, 28.714999237060546, 26.803999475479124, 26.559999356269834, 27.640999308586117, 27.790999356269843, 26.580999427795412, 26.414999356269835, 29.841999165534972, 27.131999451637263, 25.32699935626983, 26.042999403953555, 25.079999403953554, 27.90199918937683, 27.18599921321868, 27.551999380111695, 30.03699928474426, 27.711999427795412, 26.048999403953548, 27.371999213218693, 27.736999284744265, 27.74999918937683, 27.58899928474426, 25.614999475479124, 29.110999213218683, 27.842999237060546, 28.428999237060545, 27.66099935626984, 27.056999237060552, 27.52599926090241, 29.694999117851257, 26.19699933242798, 26.910999427795407, 25.46199949932098, 29.85199935626984, 28.28999918937683, 28.32199940395356, 24.995999451637267, 27.48899930858612, 26.01499933242798, 25.5209995470047, 27.476999237060543, 26.770999117851257, 26.975999332427975, 23.490999475479125, 27.244999380111697, 27.07899940395355, 27.769999237060546, 26.230999332427974, 27.726999189376833, 25.280999451637268, 28.187999403953558, 27.737999308586115, 27.816999260902406, 27.081999165534974, 29.25699902248383, 24.31399961853027, 21.524999666213994, 22.432999666213988, 22.3099995470047, 21.77199966621399, 21.58799966621399, 25.031999380111692, 22.594999737739563, 20.697999713897705, 23.540999523162842, 20.760999713897707, 24.433999380111693, 22.556999594688417, 25.599999499320983, 23.138999570846558, 22.055999785423275, 25.14899957084656, 21.06199976158142, 24.243999332427983, 22.99199945163727, 24.622999618530272, 24.90999940395355, 24.36099957084656, 20.79999973773956, 23.550999499320984, 21.8009995470047, 23.463999642372134, 20.98699964237213, 23.148999618530272, 23.416999499320983, 27.71199916553498, 24.405999570846554, 22.892999642372132, 23.521999499320984, 23.77499940395355, 26.295999403953555, 24.650999451637272, 23.476999618530268, 23.112999499320978, 22.367999523162837, 21.24399952316284, 21.256999690055846, 20.65999966621399, 20.642999666213992, 23.16999957084656, 25.517999499320982, 23.461999547004698, 20.989999642372133, 23.18799952316284, 23.408999713897703, 22.716999594688417, 23.77099940395355, 23.18899959468841, 21.54699957084656, 24.596999451637274, 20.249999809265134, 20.76799964237213, 22.85499964237213, 21.093999761581422, 22.199999690055847, 22.07399957084656, 23.496999547004698, 22.625999523162847, 25.18799940395355, 21.06399959468842, 22.541999499320983, 20.84799959468841, 22.901999451637266, 24.715999403953557, 23.551999451637272, 24.478999499320988, 24.28299945163727, 20.667999785423273, 22.41599961853028, 23.463999451637267, 23.036999570846557, 24.913999380111694, 24.50399957084656, 20.90899976158142, 23.27499942779541, 22.814999547004696, 21.932999809265137, 23.463999642372134, 23.114999523162844, 22.9219995470047, 24.31599945163727, 22.289999570846557, 23.800999547004693, 24.066999570846555, 26.146999332427974, 23.67999952316284, 20.715999690055845, 23.492999642372133, 21.920999690055847, 24.490999427795412, 22.192999618530273, 24.296999499320982, 21.399999547004704, 22.73899964237213, 22.675999856948856, 22.580999594688414, 25.846999618530276, 23.502999618530275, 24.007999690055847, 21.905999523162844, 22.757999594688414, 22.5449995470047, 24.116999594688416, 20.11699966621399, 24.6479995470047, 23.85299940395355, 24.247999451637273, 23.271999618530273, 23.446999570846565, 25.480999380111697, 24.652999380111694, 21.840999713897702, 23.30899966621399, 25.160999475479127, 24.152999451637267, 22.60799978542328, 23.22799957084656, 22.550999618530277, 23.314999523162836, 23.642999594688412], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0559042579550442, "mean_inference_ms": 0.8857349339494545, "mean_action_processing_ms": 0.09764518127543116, "mean_env_wait_ms": 0.05951461702997417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026465415954589844, "StateBufferConnector_ms": 0.035365867614746097, "ViewRequirementAgentConnector_ms": 0.23905277252197266}}, "episode_reward_max": 30.555999022483824, "episode_reward_min": 20.11699966621399, "episode_reward_mean": 25.23053543265915, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.514999165534974, 29.866999165534974, 26.85699942779541, 26.66799930858612, 28.470999189376833, 28.80299911785126, 27.46399930858612, 24.133999380111693, 26.597999356269835, 25.110999499320982, 27.479999308586123, 27.30099928474426, 28.569999284744267, 25.172999403953554, 25.572999356269836, 28.583999189376833, 28.249999260902406, 30.09799916553497, 24.16299947547913, 27.791999237060544, 27.50699938011169, 28.960999165534975, 24.955999523162845, 28.012999403953554, 27.19499930858612, 26.994999427795413, 25.23899933242798, 29.110999141693114, 29.30399916553498, 25.871999284744255, 28.98399911785126, 27.69399923706055, 25.089999570846555, 29.467999070167544, 28.187999213218692, 26.459999380111693, 28.852999284744257, 28.989999165534975, 25.67099942779541, 27.974999260902404, 27.52799916553498, 30.555999022483824, 29.201999260902404, 26.265999380111694, 29.505999070167547, 28.787999237060546, 29.996999284744263, 29.57299899864197, 26.285999260902408, 28.03299928474426, 27.549999308586127, 26.237999332427975, 27.103999165534976, 30.021999070167542, 28.87899923706055, 25.950999260902407, 28.045999094009403, 23.19699942779541, 27.51399933242798, 27.56999918937683, 27.228999308586125, 25.20599945163727, 25.935999475479125, 27.256999332427974, 27.537999213218686, 25.81499952316284, 27.120999165534972, 26.858999356269834, 28.186999332427977, 26.90899935626984, 28.714999237060546, 26.803999475479124, 26.559999356269834, 27.640999308586117, 27.790999356269843, 26.580999427795412, 26.414999356269835, 29.841999165534972, 27.131999451637263, 25.32699935626983, 26.042999403953555, 25.079999403953554, 27.90199918937683, 27.18599921321868, 27.551999380111695, 30.03699928474426, 27.711999427795412, 26.048999403953548, 27.371999213218693, 27.736999284744265, 27.74999918937683, 27.58899928474426, 25.614999475479124, 29.110999213218683, 27.842999237060546, 28.428999237060545, 27.66099935626984, 27.056999237060552, 27.52599926090241, 29.694999117851257, 26.19699933242798, 26.910999427795407, 25.46199949932098, 29.85199935626984, 28.28999918937683, 28.32199940395356, 24.995999451637267, 27.48899930858612, 26.01499933242798, 25.5209995470047, 27.476999237060543, 26.770999117851257, 26.975999332427975, 23.490999475479125, 27.244999380111697, 27.07899940395355, 27.769999237060546, 26.230999332427974, 27.726999189376833, 25.280999451637268, 28.187999403953558, 27.737999308586115, 27.816999260902406, 27.081999165534974, 29.25699902248383, 24.31399961853027, 21.524999666213994, 22.432999666213988, 22.3099995470047, 21.77199966621399, 21.58799966621399, 25.031999380111692, 22.594999737739563, 20.697999713897705, 23.540999523162842, 20.760999713897707, 24.433999380111693, 22.556999594688417, 25.599999499320983, 23.138999570846558, 22.055999785423275, 25.14899957084656, 21.06199976158142, 24.243999332427983, 22.99199945163727, 24.622999618530272, 24.90999940395355, 24.36099957084656, 20.79999973773956, 23.550999499320984, 21.8009995470047, 23.463999642372134, 20.98699964237213, 23.148999618530272, 23.416999499320983, 27.71199916553498, 24.405999570846554, 22.892999642372132, 23.521999499320984, 23.77499940395355, 26.295999403953555, 24.650999451637272, 23.476999618530268, 23.112999499320978, 22.367999523162837, 21.24399952316284, 21.256999690055846, 20.65999966621399, 20.642999666213992, 23.16999957084656, 25.517999499320982, 23.461999547004698, 20.989999642372133, 23.18799952316284, 23.408999713897703, 22.716999594688417, 23.77099940395355, 23.18899959468841, 21.54699957084656, 24.596999451637274, 20.249999809265134, 20.76799964237213, 22.85499964237213, 21.093999761581422, 22.199999690055847, 22.07399957084656, 23.496999547004698, 22.625999523162847, 25.18799940395355, 21.06399959468842, 22.541999499320983, 20.84799959468841, 22.901999451637266, 24.715999403953557, 23.551999451637272, 24.478999499320988, 24.28299945163727, 20.667999785423273, 22.41599961853028, 23.463999451637267, 23.036999570846557, 24.913999380111694, 24.50399957084656, 20.90899976158142, 23.27499942779541, 22.814999547004696, 21.932999809265137, 23.463999642372134, 23.114999523162844, 22.9219995470047, 24.31599945163727, 22.289999570846557, 23.800999547004693, 24.066999570846555, 26.146999332427974, 23.67999952316284, 20.715999690055845, 23.492999642372133, 21.920999690055847, 24.490999427795412, 22.192999618530273, 24.296999499320982, 21.399999547004704, 22.73899964237213, 22.675999856948856, 22.580999594688414, 25.846999618530276, 23.502999618530275, 24.007999690055847, 21.905999523162844, 22.757999594688414, 22.5449995470047, 24.116999594688416, 20.11699966621399, 24.6479995470047, 23.85299940395355, 24.247999451637273, 23.271999618530273, 23.446999570846565, 25.480999380111697, 24.652999380111694, 21.840999713897702, 23.30899966621399, 25.160999475479127, 24.152999451637267, 22.60799978542328, 23.22799957084656, 22.550999618530277, 23.314999523162836, 23.642999594688412], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0559042579550442, "mean_inference_ms": 0.8857349339494545, "mean_action_processing_ms": 0.09764518127543116, "mean_env_wait_ms": 0.05951461702997417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026465415954589844, "StateBufferConnector_ms": 0.035365867614746097, "ViewRequirementAgentConnector_ms": 0.23905277252197266}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 437.7624352272188, "num_env_steps_trained_throughput_per_sec": 437.7624352272188, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 8868.812, "sample_time_ms": 4228.898, "load_time_ms": 0.324, "load_throughput": 12327124.173, "learn_time_ms": 4636.858, "learn_throughput": 862.653, "synch_weights_time_ms": 2.035}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": true, "episodes_total": 720, "training_iteration": 3, "trial_id": "3a6ba_00000", "date": "2023-08-26_17-00-31", "timestamp": 1693062031, "time_this_iter_s": 9.15410566329956, "time_total_s": 26.647167921066284, "pid": 37617, "hostname": "FileWalker", "node_ip": "134.155.26.173", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "CollusionDilemmaLargeEnv", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f0ff1ecf4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 26.647167921066284, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.800000000000004, "ram_util_percent": 83.68461538461537}}
